import{c as f,r as d,w as N,a as R,h as r,T as M,_ as P,m as Q,q as D,s as F,t as V,u as X,B as i,C as y,v as S}from"./index.1290fcd1.js";import{c as j,h as E,r as A}from"./QBtn.70c0b5f7.js";import{Q as H}from"./QPage.f5df25c2.js";import{Q as L}from"./index.esm.ba0f6273.js";import"./position-engine.e08c2a66.js";import"./selection.8e7a3623.js";import"./scroll.f8823e45.js";const O={ratio:[String,Number]};function U(e,o){return f(()=>{const l=Number(e.ratio||(o!==void 0?o.value:void 0));return isNaN(l)!==!0&&l>0?{paddingBottom:`${100/l}%`}:null})}const W=16/9;var Y=j({name:"QImg",props:{...O,src:String,srcset:String,sizes:String,alt:String,crossorigin:String,decoding:String,referrerpolicy:String,draggable:Boolean,loading:{type:String,default:"lazy"},fetchpriority:{type:String,default:"auto"},width:String,height:String,initialRatio:{type:[Number,String],default:W},placeholderSrc:String,fit:{type:String,default:"cover"},position:{type:String,default:"50% 50%"},imgClass:String,imgStyle:Object,noSpinner:Boolean,noNativeMenu:Boolean,noTransition:Boolean,spinnerColor:String,spinnerSize:String},emits:["load","error"],setup(e,{slots:o,emit:l}){const _=d(e.initialRatio),h=U(e,_);let a;const n=[d(null),d(e.placeholderSrc!==void 0?{src:e.placeholderSrc}:null)],u=d(0),c=d(!1),m=d(!1),w=f(()=>`q-img q-img--${e.noNativeMenu===!0?"no-":""}menu`),C=f(()=>({width:e.width,height:e.height})),q=f(()=>`q-img__image ${e.imgClass!==void 0?e.imgClass+" ":""}q-img__image--with${e.noTransition===!0?"out":""}-transition`),T=f(()=>({...e.imgStyle,objectFit:e.fit,objectPosition:e.position}));N(()=>v(),b);function v(){return e.src||e.srcset||e.sizes?{src:e.src,srcset:e.srcset,sizes:e.sizes}:null}function b(t){if(clearTimeout(a),m.value=!1,t===null){c.value=!1,n[0].value=null,n[1].value=null;return}c.value=!0,n[u.value].value=t}function k({target:t}){a!==null&&(clearTimeout(a),_.value=t.naturalHeight===0?.5:t.naturalWidth/t.naturalHeight,p(t,1))}function p(t,s){a===null||s===1e3||(t.complete===!0?B(t):a=setTimeout(()=>{p(t,s+1)},50))}function B(t){a!==null&&(u.value=u.value===1?0:1,n[u.value].value=null,c.value=!1,m.value=!1,l("load",t.currentSrc||t.src))}function z(t){clearTimeout(a),c.value=!1,m.value=!0,n[0].value=null,n[1].value=null,l("error",t)}function $(t,s){return r("div",{class:"q-img__container absolute-full",key:t},s)}function x(t){const s=n[t].value,g={key:"img_"+t,class:q.value,style:T.value,crossorigin:e.crossorigin,decoding:e.decoding,referrerpolicy:e.referrerpolicy,height:e.height,width:e.width,loading:e.loading,fetchpriority:e.fetchpriority,"aria-hidden":"true",draggable:e.draggable,...s};return u.value===t?(g.class+=" q-img__image--waiting",Object.assign(g,{onLoad:k,onError:z})):g.class+=" q-img__image--loaded",$("img"+t,r("img",g))}function I(){return c.value!==!0?r("div",{key:"content",class:"q-img__content absolute-full q-anchor--skip"},E(o[m.value===!0?"error":"default"])):r("div",{key:"loading",class:"q-img__loading absolute-full flex flex-center"},o.loading!==void 0?o.loading():e.noSpinner===!0?void 0:[r(A,{color:e.spinnerColor,size:e.spinnerSize})])}return b(v()),R(()=>{clearTimeout(a),a=null}),()=>{const t=[];return h.value!==null&&t.push(r("div",{key:"filler",style:h.value})),m.value!==!0&&(n[0].value!==null&&t.push(x(0)),n[1].value!==null&&t.push(x(1))),t.push(r(M,{name:"q-transition--fade"},I)),r("div",{class:w.value,style:C.value,role:"img","aria-label":e.alt},t)}}});const Z=Q({name:"PhysarumPage",components:{QMarkdown:L},data(){return{split:60,markdown:`\`\`\`
def transform_bone_and_siblings(bone_index, parent_matrix):
  while bone_index != -1:
      flver_bone = flver_data.bones[bone_index]
      bone = armature.data.edit_bones[bone_index]
      if flver_bone.parent_index >= 0:
          bone.parent = armature.data.edit_bones[flver_bone.parent_index]

      translation_vector = Vector(
          (flver_bone.translation[0], flver_bone.translation[1],
            flver_bone.translation[2]))
      rotation_matrix = (
          Matrix.Rotation(flver_bone.rotation[1], 4, 'Y')
          @ Matrix.Rotation(flver_bone.rotation[2], 4, 'Z')
          @ Matrix.Rotation(flver_bone.rotation[0], 4, 'X'))

      head = parent_matrix @ translation_vector
      tail = head + rotation_matrix @ Vector((0, 0.05, 0))

      bone.head = (head[0], head[2], head[1])
      bone.tail = (tail[0], tail[2], tail[1])

      # Transform children and advance to next sibling
      transform_bone_and_siblings(
          flver_bone.child_index, parent_matrix
          @ Matrix.Translation(translation_vector) @ rotation_matrix)
      bone_index = flver_bone.next_sibling_index

transform_bone_and_siblings(0, Matrix())
\`\`\``}}}),G={class:"q-mt-none q-mb-lg text-primary"},J=i("div",{class:"text-h4"},"Blender DCX Importer",-1),K=i("br",null,null,-1),ee=i("p",null," An add-on for the 3D modelling program Blender to import proprietary model and texture files from FromSoftware video games. The tool unpacks the input files and loads mesh data, armature data and finds the appropriate texture data for that model. It then loads these items into Blender and applies the armature and texture data into a rigged and textured blender model. ",-1),te=i("p",null," Blender supports an extensive python API for automating any user function in the program. The add-on, using several other tools, decompresses the proprietary .dcx files. ",-1),ne=i("p",null," From this .dcx file we get a .flver (model, UV and rigging data) and a .tpf file (texture data). The .flver model data is read into memory and the model is created in blender from the vertex buffer and armature data. The .tpf is unpacked and the textures within are converted from .dds to .png using the DirectXTex texture converter. ",-1),ae=i("p",null," Finally, Blender materials are created from these textures and applied to the model. ",-1),ie=i("div",{class:"text-caption"}," Excerpt from the armature creation code: Creates, positions and links bones for the model's armature from the flver data. ",-1);function re(e,o,l,_,h,a){const n=X("q-markdown");return D(),F(H,null,{default:V(()=>[i("div",G,[J,K,i("video",{class:y(e.$q.platform.is.mobile?"center-mobile":"aside"),autoplay:"",loop:"",src:"portfolio/dcximporter_vid_0.mp4",muted:""},null,2),ee,te,S(Y,{src:"portfolio/dcximporter_img_1.webp",class:y(e.$q.platform.is.mobile?"":"aside")},null,8,["class"]),ne,ae,S(n,{style:{"line-height":"1.5",overflow:"auto","overflow-x":"auto","min-width":"0px","box-sizing":"border-box"},src:e.markdown,class:"focused"},null,8,["src"]),ie])]),_:1})}var fe=P(Z,[["render",re]]);export{fe as default};
