import{w as ce,a as Be,d as po,g as Ce,a0 as bo,c as u,h as m,r as M,a1 as qn,a2 as So,a3 as Mn,B as ye,n as Ee,a4 as Vn,a5 as Pn,o as yo,i as xo,E as _e,T as wt,G as pe,A as Ln,K as ft,O as rn,l as Ie,a6 as wo,b as Dn,N as Co,a7 as To,a8 as rt,V as ke,a9 as Eo,H as _o,I as ht,J as Ft,L as qt,P as Ro,aa as Mt,_ as Ao,m as ko,q as Vt,Q as Pt,z as Bo,v as gt,t as un,S as sn,R as Fo,y as qo,U as cn}from"./index.47c864f7.js";import{u as Mo,a as Vo,b as Ht,e as Po}from"./QBtn.ace210e5.js";import{u as Kt,a as Yt}from"./use-dark.86a592b7.js";import{c as nt,k as Lo,h as Ze,m as In,b as Do,f as Io,j as zo}from"./dom.cf56c019.js";import{m as Qt,n as Oo,u as $o,a as zn,b as On,v as dn,c as Uo,d as $n,e as Un,f as Nn,g as No,h as Ho,i as Xo,j as Hn,k as Xn,r as fn,s as jo,p as vn,l as Wo,o as Go}from"./position-engine.25adee15.js";import{b as Ko,g as mn,s as hn,a as Yo,Q as Qo}from"./QCard.a0e04afc.js";import{a as Zo,b as Jo,Q as el}from"./QItem.63371074.js";import{g as tl,b as nl,a as ol,h as ll}from"./scroll.95183e25.js";import{c as al}from"./selection.3861cc93.js";function rl({validate:e,resetValidation:t,requiresQForm:o}){const l=po(bo,!1);if(l!==!1){const{props:n,proxy:r}=Ce();Object.assign(r,{validate:e,resetValidation:t}),ce(()=>n.disable,i=>{i===!0?(typeof t=="function"&&t(),l.unbindComponent(r)):l.bindComponent(r)}),n.disable!==!0&&l.bindComponent(r),Be(()=>{n.disable!==!0&&l.unbindComponent(r)})}else o===!0&&console.error("Parent QForm not found on useFormChild()!")}const gn=/^#[0-9a-fA-F]{3}([0-9a-fA-F]{3})?$/,pn=/^#[0-9a-fA-F]{4}([0-9a-fA-F]{4})?$/,bn=/^#([0-9a-fA-F]{3}|[0-9a-fA-F]{4}|[0-9a-fA-F]{6}|[0-9a-fA-F]{8})$/,pt=/^rgb\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5])\)$/,bt=/^rgba\(((0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),){2}(0|[1-9][\d]?|1[\d]{0,2}|2[\d]?|2[0-4][\d]|25[0-5]),(0|0\.[0-9]+[1-9]|0\.[1-9]+|1)\)$/,Lt={date:e=>/^-?[\d]+\/[0-1]\d\/[0-3]\d$/.test(e),time:e=>/^([0-1]?\d|2[0-3]):[0-5]\d$/.test(e),fulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d:[0-5]\d$/.test(e),timeOrFulltime:e=>/^([0-1]?\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/.test(e),email:e=>/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e),hexColor:e=>gn.test(e),hexaColor:e=>pn.test(e),hexOrHexaColor:e=>bn.test(e),rgbColor:e=>pt.test(e),rgbaColor:e=>bt.test(e),rgbOrRgbaColor:e=>pt.test(e)||bt.test(e),hexOrRgbColor:e=>gn.test(e)||pt.test(e),hexaOrRgbaColor:e=>pn.test(e)||bt.test(e),anyColor:e=>bn.test(e)||pt.test(e)||bt.test(e)};"Boolean Number String Function Array Date RegExp Object".split(" ").forEach(e=>{e.toLowerCase()});const il={...Mo,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean};function ze(e,t,o){return o<=t?t:Math.min(o,Math.max(t,e))}function Sn(e,t,o){if(o<=t)return t;const l=o-t+1;let n=t+(e-t)%l;return n<t&&(n=l+n),n===0?0:n}const Xt=50,jn=2*Xt,Wn=jn*Math.PI,ul=Math.round(Wn*1e3)/1e3;nt({name:"QCircularProgress",props:{...il,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:t}){const{proxy:{$q:o}}=Ce(),l=Vo(e),n=u(()=>{const y=(o.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(o.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-y}deg)`:`rotate3d(0, 0, 1, ${y-90}deg)`}}),r=u(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),i=u(()=>jn/(1-e.thickness/2)),s=u(()=>`${i.value/2} ${i.value/2} ${i.value} ${i.value}`),c=u(()=>ze(e.value,e.min,e.max)),h=u(()=>Wn*(1-(c.value-e.min)/(e.max-e.min))),d=u(()=>e.thickness/2*i.value);function x({thickness:y,offset:v,color:_,cls:U}){return m("circle",{class:"q-circular-progress__"+U+(_!==void 0?` text-${_}`:""),style:r.value,fill:"transparent",stroke:"currentColor","stroke-width":y,"stroke-dasharray":ul,"stroke-dashoffset":v,cx:i.value,cy:i.value,r:Xt})}return()=>{const y=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&y.push(m("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:Xt-d.value/2,cx:i.value,cy:i.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&y.push(x({cls:"track",thickness:d.value,offset:0,color:e.trackColor})),y.push(x({cls:"circle",thickness:d.value,offset:h.value,color:e.color}));const v=[m("svg",{class:"q-circular-progress__svg",style:n.value,viewBox:s.value,"aria-hidden":"true"},y)];return e.showValue===!0&&v.push(m("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},t.default!==void 0?t.default():[m("div",c.value)])),m("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:l.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:c.value},Lo(t.internal,v))}}});const sl=["rejected"],cl=[...sl,"start","finish","added","removed"],dl=()=>!0;function fl(e){const t={};return e.forEach(o=>{t[o]=dl}),t}fl(cl);let Dt,St=0;const fe=new Array(256);for(let e=0;e<256;e++)fe[e]=(e+256).toString(16).substring(1);const vl=(()=>{const e=typeof crypto!="undefined"?crypto:typeof window!="undefined"?window.crypto||window.msCrypto:void 0;if(e!==void 0){if(e.randomBytes!==void 0)return e.randomBytes;if(e.getRandomValues!==void 0)return t=>{const o=new Uint8Array(t);return e.getRandomValues(o),o}}return t=>{const o=[];for(let l=t;l>0;l--)o.push(Math.floor(Math.random()*256));return o}})(),yn=4096;function ml(){(Dt===void 0||St+16>yn)&&(St=0,Dt=vl(yn));const e=Array.prototype.slice.call(Dt,St,St+=16);return e[6]=e[6]&15|64,e[8]=e[8]&63|128,fe[e[0]]+fe[e[1]]+fe[e[2]]+fe[e[3]]+"-"+fe[e[4]]+fe[e[5]]+"-"+fe[e[6]]+fe[e[7]]+"-"+fe[e[8]]+fe[e[9]]+"-"+fe[e[10]]+fe[e[11]]+fe[e[12]]+fe[e[13]]+fe[e[14]]+fe[e[15]]}const hl=[!0,!1,"ondemand"],pl={modelValue:{},error:{type:Boolean,default:null},errorMessage:String,noErrorIcon:Boolean,rules:Array,reactiveRules:Boolean,lazyRules:{type:[Boolean,String],validator:e=>hl.includes(e)}};function bl(e,t){const{props:o,proxy:l}=Ce(),n=M(!1),r=M(null),i=M(null);rl({validate:_,resetValidation:v});let s=0,c;const h=u(()=>o.rules!==void 0&&o.rules!==null&&o.rules.length>0),d=u(()=>o.disable!==!0&&h.value===!0),x=u(()=>o.error===!0||n.value===!0),y=u(()=>typeof o.errorMessage=="string"&&o.errorMessage.length>0?o.errorMessage:r.value);ce(()=>o.modelValue,()=>{U()}),ce(()=>o.reactiveRules,P=>{P===!0?c===void 0&&(c=ce(()=>o.rules,()=>{U(!0)})):c!==void 0&&(c(),c=void 0)},{immediate:!0}),ce(e,P=>{P===!0?i.value===null&&(i.value=!1):i.value===!1&&(i.value=!0,d.value===!0&&o.lazyRules!=="ondemand"&&t.value===!1&&I())});function v(){s++,t.value=!1,i.value=null,n.value=!1,r.value=null,I.cancel()}function _(P=o.modelValue){if(d.value!==!0)return!0;const V=++s;t.value!==!0&&o.lazyRules!==!0&&(i.value=!0);const B=(R,$)=>{n.value!==R&&(n.value=R);const D=$||void 0;r.value!==D&&(r.value=D),t.value=!1},F=[];for(let R=0;R<o.rules.length;R++){const $=o.rules[R];let D;if(typeof $=="function"?D=$(P,Lt):typeof $=="string"&&Lt[$]!==void 0&&(D=Lt[$](P)),D===!1||typeof D=="string")return B(!0,D),!1;D!==!0&&D!==void 0&&F.push(D)}return F.length===0?(B(!1),!0):(t.value=!0,Promise.all(F).then(R=>{if(R===void 0||Array.isArray(R)===!1||R.length===0)return V===s&&B(!1),!0;const $=R.find(D=>D===!1||typeof D=="string");return V===s&&B($!==void 0,$),$===void 0},R=>(V===s&&(console.error(R),B(!0)),!1)))}function U(P){d.value===!0&&o.lazyRules!=="ondemand"&&(i.value===!0||o.lazyRules!==!0&&P!==!0)&&I()}const I=qn(_,0);return Be(()=>{c!==void 0&&c(),I.cancel()}),Object.assign(l,{resetValidation:v,validate:_}),So(l,"hasError",()=>x.value),{isDirtyModel:i,hasRules:h,hasError:x,errorMessage:y,validate:_,resetValidation:v}}const xn=/^on[A-Z]/;function Sl(e,t){const o={listeners:M({}),attributes:M({})};function l(){const n={},r={};for(const i in e)i!=="class"&&i!=="style"&&xn.test(i)===!1&&(n[i]=e[i]);for(const i in t.props)xn.test(i)===!0&&(r[i]=t.props[i]);o.attributes.value=n,o.listeners.value=r}return Mn(l),l(),o}function jt(e){return e===void 0?`f_${ml()}`:e}function Wt(e){return e!=null&&(""+e).length>0}const Zt={...Kt,...pl,label:String,stackLabel:Boolean,hint:String,hideHint:Boolean,prefix:String,suffix:String,labelColor:String,color:String,bgColor:String,filled:Boolean,outlined:Boolean,borderless:Boolean,standout:[Boolean,String],square:Boolean,loading:Boolean,labelSlot:Boolean,bottomSlots:Boolean,hideBottomSpace:Boolean,rounded:Boolean,dense:Boolean,itemAligned:Boolean,counter:Boolean,clearable:Boolean,clearIcon:String,disable:Boolean,readonly:Boolean,autofocus:Boolean,for:String,maxlength:[Number,String]},Gn=["update:modelValue","clear","focus","blur","popup-show","popup-hide"];function Kn(){const{props:e,attrs:t,proxy:o,vnode:l}=Ce();return{isDark:Yt(e,o.$q),editable:u(()=>e.disable!==!0&&e.readonly!==!0),innerLoading:M(!1),focused:M(!1),hasPopupOpen:!1,splitAttrs:Sl(t,l),targetUid:M(jt(e.for)),rootRef:M(null),targetRef:M(null),controlRef:M(null)}}function Yn(e){const{props:t,emit:o,slots:l,attrs:n,proxy:r}=Ce(),{$q:i}=r;let s;e.hasValue===void 0&&(e.hasValue=u(()=>Wt(t.modelValue))),e.emitValue===void 0&&(e.emitValue=C=>{o("update:modelValue",C)}),e.controlEvents===void 0&&(e.controlEvents={onFocusin:le,onFocusout:Z}),Object.assign(e,{clearValue:H,onControlFocusin:le,onControlFocusout:Z,focus:D}),e.computedCounter===void 0&&(e.computedCounter=u(()=>{if(t.counter!==!1){const C=typeof t.modelValue=="string"||typeof t.modelValue=="number"?(""+t.modelValue).length:Array.isArray(t.modelValue)===!0?t.modelValue.length:0,z=t.maxlength!==void 0?t.maxlength:t.maxValues;return C+(z!==void 0?" / "+z:"")}}));const{isDirtyModel:c,hasRules:h,hasError:d,errorMessage:x,resetValidation:y}=bl(e.focused,e.innerLoading),v=e.floatingLabel!==void 0?u(()=>t.stackLabel===!0||e.focused.value===!0||e.floatingLabel.value===!0):u(()=>t.stackLabel===!0||e.focused.value===!0||e.hasValue.value===!0),_=u(()=>t.bottomSlots===!0||t.hint!==void 0||h.value===!0||t.counter===!0||t.error!==null),U=u(()=>t.filled===!0?"filled":t.outlined===!0?"outlined":t.borderless===!0?"borderless":t.standout?"standout":"standard"),I=u(()=>`q-field row no-wrap items-start q-field--${U.value}`+(e.fieldClass!==void 0?` ${e.fieldClass.value}`:"")+(t.rounded===!0?" q-field--rounded":"")+(t.square===!0?" q-field--square":"")+(v.value===!0?" q-field--float":"")+(V.value===!0?" q-field--labeled":"")+(t.dense===!0?" q-field--dense":"")+(t.itemAligned===!0?" q-field--item-aligned q-item-type":"")+(e.isDark.value===!0?" q-field--dark":"")+(e.getControl===void 0?" q-field--auto-height":"")+(e.focused.value===!0?" q-field--focused":"")+(d.value===!0?" q-field--error":"")+(d.value===!0||e.focused.value===!0?" q-field--highlighted":"")+(t.hideBottomSpace!==!0&&_.value===!0?" q-field--with-bottom":"")+(t.disable===!0?" q-field--disabled":t.readonly===!0?" q-field--readonly":"")),P=u(()=>"q-field__control relative-position row no-wrap"+(t.bgColor!==void 0?` bg-${t.bgColor}`:"")+(d.value===!0?" text-negative":typeof t.standout=="string"&&t.standout.length>0&&e.focused.value===!0?` ${t.standout}`:t.color!==void 0?` text-${t.color}`:"")),V=u(()=>t.labelSlot===!0||t.label!==void 0),B=u(()=>"q-field__label no-pointer-events absolute ellipsis"+(t.labelColor!==void 0&&d.value!==!0?` text-${t.labelColor}`:"")),F=u(()=>({id:e.targetUid.value,editable:e.editable.value,focused:e.focused.value,floatingLabel:v.value,modelValue:t.modelValue,emitValue:e.emitValue})),R=u(()=>{const C={for:e.targetUid.value};return t.disable===!0?C["aria-disabled"]="true":t.readonly===!0&&(C["aria-readonly"]="true"),C});ce(()=>t.for,C=>{e.targetUid.value=jt(C)});function $(){const C=document.activeElement;let z=e.targetRef!==void 0&&e.targetRef.value;z&&(C===null||C.id!==e.targetUid.value)&&(z.hasAttribute("tabindex")===!0||(z=z.querySelector("[tabindex]")),z&&z!==C&&z.focus({preventScroll:!0}))}function D(){Qt($)}function J(){Oo($);const C=document.activeElement;C!==null&&e.rootRef.value.contains(C)&&C.blur()}function le(C){clearTimeout(s),e.editable.value===!0&&e.focused.value===!1&&(e.focused.value=!0,o("focus",C))}function Z(C,z){clearTimeout(s),s=setTimeout(()=>{document.hasFocus()===!0&&(e.hasPopupOpen===!0||e.controlRef===void 0||e.controlRef.value===null||e.controlRef.value.contains(document.activeElement)!==!1)||(e.focused.value===!0&&(e.focused.value=!1,o("blur",C)),z!==void 0&&z())})}function H(C){ye(C),i.platform.is.mobile!==!0?(e.targetRef!==void 0&&e.targetRef.value||e.rootRef.value).focus():e.rootRef.value.contains(document.activeElement)===!0&&document.activeElement.blur(),t.type==="file"&&(e.inputRef.value.value=null),o("update:modelValue",null),o("clear",t.modelValue),Ee(()=>{y(),i.platform.is.mobile!==!0&&(c.value=!1)})}function ne(){const C=[];return l.prepend!==void 0&&C.push(m("div",{class:"q-field__prepend q-field__marginal row no-wrap items-center",key:"prepend",onClick:_e},l.prepend())),C.push(m("div",{class:"q-field__control-container col relative-position row no-wrap q-anchor--skip"},oe())),d.value===!0&&t.noErrorIcon===!1&&C.push(G("error",[m(Ht,{name:i.iconSet.field.error,color:"negative"})])),t.loading===!0||e.innerLoading.value===!0?C.push(G("inner-loading-append",l.loading!==void 0?l.loading():[m(Po,{color:t.color})])):t.clearable===!0&&e.hasValue.value===!0&&e.editable.value===!0&&C.push(G("inner-clearable-append",[m(Ht,{class:"q-field__focusable-action",tag:"button",name:t.clearIcon||i.iconSet.field.clear,tabindex:0,type:"button","aria-hidden":null,role:null,onClick:H})])),l.append!==void 0&&C.push(m("div",{class:"q-field__append q-field__marginal row no-wrap items-center",key:"append",onClick:_e},l.append())),e.getInnerAppend!==void 0&&C.push(G("inner-append",e.getInnerAppend())),e.getControlChild!==void 0&&C.push(e.getControlChild()),C}function oe(){const C=[];return t.prefix!==void 0&&t.prefix!==null&&C.push(m("div",{class:"q-field__prefix no-pointer-events row items-center"},t.prefix)),e.getShadowControl!==void 0&&e.hasShadow.value===!0&&C.push(e.getShadowControl()),e.getControl!==void 0?C.push(e.getControl()):l.rawControl!==void 0?C.push(l.rawControl()):l.control!==void 0&&C.push(m("div",{ref:e.targetRef,class:"q-field__native row",tabindex:-1,...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0},l.control(F.value))),V.value===!0&&C.push(m("div",{class:B.value},Ze(l.label,t.label))),t.suffix!==void 0&&t.suffix!==null&&C.push(m("div",{class:"q-field__suffix no-pointer-events row items-center"},t.suffix)),C.concat(Ze(l.default))}function ee(){let C,z;d.value===!0?x.value!==null?(C=[m("div",{role:"alert"},x.value)],z=`q--slot-error-${x.value}`):(C=Ze(l.error),z="q--slot-error"):(t.hideHint!==!0||e.focused.value===!0)&&(t.hint!==void 0?(C=[m("div",t.hint)],z=`q--slot-hint-${t.hint}`):(C=Ze(l.hint),z="q--slot-hint"));const ve=t.counter===!0||l.counter!==void 0;if(t.hideBottomSpace===!0&&ve===!1&&C===void 0)return;const g=m("div",{key:z,class:"q-field__messages col"},C);return m("div",{class:"q-field__bottom row items-start q-field__bottom--"+(t.hideBottomSpace!==!0?"animated":"stale"),onClick:_e},[t.hideBottomSpace===!0?g:m(wt,{name:"q-transition--field-message"},()=>g),ve===!0?m("div",{class:"q-field__counter"},l.counter!==void 0?l.counter():e.computedCounter.value):null])}function G(C,z){return z===null?null:m("div",{key:C,class:"q-field__append q-field__marginal row no-wrap items-center q-anchor--skip"},z)}let de=!1;return Vn(()=>{de=!0}),Pn(()=>{de===!0&&t.autofocus===!0&&r.focus()}),yo(()=>{xo.value===!0&&t.for===void 0&&(e.targetUid.value=jt()),t.autofocus===!0&&r.focus()}),Be(()=>{clearTimeout(s)}),Object.assign(r,{focus:D,blur:J}),function(){const z=e.getControl===void 0&&l.control===void 0?{...e.splitAttrs.attributes.value,"data-autofocus":t.autofocus===!0||void 0,...R.value}:R.value;return m("label",{ref:e.rootRef,class:[I.value,n.class],style:n.style,...z},[l.before!==void 0?m("div",{class:"q-field__before q-field__marginal row no-wrap items-center",onClick:_e},l.before()):null,m("div",{class:"q-field__inner relative-position col self-stretch"},[m("div",{ref:e.controlRef,class:P.value,tabindex:-1,...e.controlEvents},ne()),_.value===!0?ee():null]),l.after!==void 0?m("div",{class:"q-field__after q-field__marginal row no-wrap items-center",onClick:_e},l.after()):null])}}var yl=nt({name:"QField",inheritAttrs:!1,props:Zt,emits:Gn,setup(){return Yn(Kn())}});const Oe=[];let tt;function xl(e){tt=e.keyCode===27}function wl(){tt===!0&&(tt=!1)}function Cl(e){tt===!0&&(tt=!1,Ln(e,27)===!0&&Oe[Oe.length-1](e))}function Qn(e){window[e]("keydown",xl),window[e]("blur",wl),window[e]("keyup",Cl),tt=!1}function Zn(e){pe.is.desktop===!0&&(Oe.push(e),Oe.length===1&&Qn("addEventListener"))}function Ct(e){const t=Oe.indexOf(e);t>-1&&(Oe.splice(t,1),Oe.length===0&&Qn("removeEventListener"))}const $e=[];function Jn(e){$e[$e.length-1](e)}function eo(e){pe.is.desktop===!0&&($e.push(e),$e.length===1&&document.body.addEventListener("focusin",Jn))}function Gt(e){const t=$e.indexOf(e);t>-1&&($e.splice(t,1),$e.length===0&&document.body.removeEventListener("focusin",Jn))}var Tl=nt({name:"QMenu",inheritAttrs:!1,props:{...$o,...zn,...Kt,...On,persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:dn},self:{type:String,validator:dn},offset:{type:Array,validator:Uo},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}},emits:[...$n,"click","escape-key"],setup(e,{slots:t,emit:o,attrs:l}){let n=null,r,i,s;const c=Ce(),{proxy:h}=c,{$q:d}=h,x=M(null),y=M(!1),v=u(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),_=Yt(e,d),{registerTick:U,removeTick:I}=Un(),{registerTimeout:P,removeTimeout:V}=Nn(),{transition:B,transitionStyle:F}=No(e,y),{localScrollTarget:R,changeScrollEvent:$,unconfigureScrollTarget:D}=Ho(e,N),{anchorEl:J,canShow:le}=Xo({showing:y}),{hide:Z}=Hn({showing:y,canShow:le,handleShow:p,handleHide:E,hideOnRouteChange:v,processOnMount:!0}),{showPortal:H,hidePortal:ne,renderPortal:oe}=Xn(c,x,b),ee={anchorEl:J,innerRef:x,onClickOutside(T){if(e.persistent!==!0&&y.value===!0)return Z(T),(T.type==="touchstart"||T.target.classList.contains("q-dialog__backdrop"))&&ye(T),!0}},G=u(()=>vn(e.anchor||(e.cover===!0?"center middle":"bottom start"),d.lang.rtl)),de=u(()=>e.cover===!0?G.value:vn(e.self||"top start",d.lang.rtl)),C=u(()=>(e.square===!0?" q-menu--square":"")+(_.value===!0?" q-menu--dark q-dark":"")),z=u(()=>e.autoClose===!0?{onClick:te}:{}),ve=u(()=>y.value===!0&&e.persistent!==!0);ce(ve,T=>{T===!0?(Zn(A),Wo(ee)):(Ct(A),fn(ee))});function g(){Qt(()=>{let T=x.value;T&&T.contains(document.activeElement)!==!0&&(T=T.querySelector("[autofocus], [data-autofocus]")||T,T.focus({preventScroll:!0}))})}function p(T){if(I(),V(),n=e.noRefocus===!1?document.activeElement:null,eo(L),H(),N(),r=void 0,T!==void 0&&(e.touchPosition||e.contextMenu)){const ie=ft(T);if(ie.left!==void 0){const{top:be,left:ue}=J.value.getBoundingClientRect();r={left:ie.left-ue,top:ie.top-be}}}i===void 0&&(i=ce(()=>d.screen.width+"|"+d.screen.height+"|"+e.self+"|"+e.anchor+"|"+d.lang.rtl,K)),e.noFocus!==!0&&document.activeElement.blur(),U(()=>{K(),e.noFocus!==!0&&g()}),P(()=>{d.platform.is.ios===!0&&(s=e.autoClose,x.value.click()),K(),H(!0),o("show",T)},e.transitionDuration)}function E(T){I(),V(),ne(),k(!0),n!==null&&(T===void 0||T.qClickOutside!==!0)&&(n.focus(),n=null),P(()=>{ne(!0),o("hide",T)},e.transitionDuration)}function k(T){r=void 0,i!==void 0&&(i(),i=void 0),(T===!0||y.value===!0)&&(Gt(L),D(),fn(ee),Ct(A)),T!==!0&&(n=null)}function N(){(J.value!==null||e.scrollTarget!==void 0)&&(R.value=tl(J.value,e.scrollTarget),$(R.value,K))}function te(T){s!==!0?(Go(h,T),o("click",T)):s=!1}function L(T){ve.value===!0&&e.noFocus!==!0&&In(x.value,T.target)!==!0&&g()}function A(T){o("escape-key"),Z(T)}function K(){const T=x.value;T===null||J.value===null||jo({el:T,offset:e.offset,anchorEl:J.value,anchorOrigin:G.value,selfOrigin:de.value,absoluteOffset:r,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function b(){return m(wt,{name:B.value,appear:!0},()=>y.value===!0?m("div",{...l,ref:x,tabindex:-1,class:["q-menu q-position-engine scroll"+C.value,l.class],style:[l.style,F.value],...z.value},Ze(t.default)):null)}return Be(k),Object.assign(h,{focus:g,updatePosition:K}),oe}});function El(e,t,o){let l;function n(){l!==void 0&&(rn.remove(l),l=void 0)}return Be(()=>{e.value===!0&&n()}),{removeFromHistory:n,addToHistory(){l={condition:()=>o.value===!0,handler:t},rn.add(l)}}}let it=0,It,zt,dt,Ot=!1,wn,Cn,Qe;function _l(e){Rl(e)&&ye(e)}function Rl(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=wo(e),o=e.shiftKey&&!e.deltaX,l=!o&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),n=o||l?e.deltaY:e.deltaX;for(let r=0;r<t.length;r++){const i=t[r];if(ll(i,l))return l?n<0&&i.scrollTop===0?!0:n>0&&i.scrollTop+i.clientHeight===i.scrollHeight:n<0&&i.scrollLeft===0?!0:n>0&&i.scrollLeft+i.clientWidth===i.scrollWidth}return!0}function Tn(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function yt(e){Ot!==!0&&(Ot=!0,requestAnimationFrame(()=>{Ot=!1;const{height:t}=e.target,{clientHeight:o,scrollTop:l}=document.scrollingElement;(dt===void 0||t!==window.innerHeight)&&(dt=o-t,document.scrollingElement.scrollTop=l),l>dt&&(document.scrollingElement.scrollTop-=Math.ceil((l-dt)/8))}))}function En(e){const t=document.body,o=window.visualViewport!==void 0;if(e==="add"){const{overflowY:l,overflowX:n}=window.getComputedStyle(t);It=nl(window),zt=ol(window),wn=t.style.left,Cn=t.style.top,t.style.left=`-${It}px`,t.style.top=`-${zt}px`,n!=="hidden"&&(n==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),l!=="hidden"&&(l==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,pe.is.ios===!0&&(o===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",yt,Ie.passiveCapture),window.visualViewport.addEventListener("scroll",yt,Ie.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",Tn,Ie.passiveCapture))}pe.is.desktop===!0&&pe.is.mac===!0&&window[`${e}EventListener`]("wheel",_l,Ie.notPassive),e==="remove"&&(pe.is.ios===!0&&(o===!0?(window.visualViewport.removeEventListener("resize",yt,Ie.passiveCapture),window.visualViewport.removeEventListener("scroll",yt,Ie.passiveCapture)):window.removeEventListener("scroll",Tn,Ie.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=wn,t.style.top=Cn,window.scrollTo(It,zt),dt=void 0)}function Al(e){let t="add";if(e===!0){if(it++,Qe!==void 0){clearTimeout(Qe),Qe=void 0;return}if(it>1)return}else{if(it===0||(it--,it>0))return;if(t="remove",pe.is.ios===!0&&pe.is.nativeMobile===!0){clearTimeout(Qe),Qe=setTimeout(()=>{En(t),Qe=void 0},100);return}}En(t)}function kl(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,Al(t))}}}let xt=0;const Bl={standard:"fixed-full flex-center",top:"fixed-top justify-center",bottom:"fixed-bottom justify-center",right:"fixed-right items-center",left:"fixed-left items-center"},_n={standard:["scale","scale"],top:["slide-down","slide-up"],bottom:["slide-up","slide-down"],right:["slide-left","slide-right"],left:["slide-right","slide-left"]};var Fl=nt({name:"QDialog",inheritAttrs:!1,props:{...zn,...On,transitionShow:String,transitionHide:String,persistent:Boolean,autoClose:Boolean,allowFocusOutside:Boolean,noEscDismiss:Boolean,noBackdropDismiss:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,noShake:Boolean,seamless:Boolean,maximized:Boolean,fullWidth:Boolean,fullHeight:Boolean,square:Boolean,position:{type:String,default:"standard",validator:e=>e==="standard"||["top","bottom","left","right"].includes(e)}},emits:[...$n,"shake","click","escape-key"],setup(e,{slots:t,emit:o,attrs:l}){const n=Ce(),r=M(null),i=M(!1),s=M(!1),c=M(!1);let h,d=null,x,y;const v=u(()=>e.persistent!==!0&&e.noRouteDismiss!==!0&&e.seamless!==!0),{preventBodyScroll:_}=kl(),{registerTimeout:U,removeTimeout:I}=Nn(),{registerTick:P,removeTick:V}=Un(),{showPortal:B,hidePortal:F,portalIsAccessible:R,renderPortal:$}=Xn(n,r,K,!0),{hide:D}=Hn({showing:i,hideOnRouteChange:v,handleShow:z,handleHide:ve,processOnMount:!0}),{addToHistory:J,removeFromHistory:le}=El(i,D,v),Z=u(()=>`q-dialog__inner flex no-pointer-events q-dialog__inner--${e.maximized===!0?"maximized":"minimized"} q-dialog__inner--${e.position} ${Bl[e.position]}`+(c.value===!0?" q-dialog__inner--animating":"")+(e.fullWidth===!0?" q-dialog__inner--fullwidth":"")+(e.fullHeight===!0?" q-dialog__inner--fullheight":"")+(e.square===!0?" q-dialog__inner--square":"")),H=u(()=>"q-transition--"+(e.transitionShow===void 0?_n[e.position][0]:e.transitionShow)),ne=u(()=>"q-transition--"+(e.transitionHide===void 0?_n[e.position][1]:e.transitionHide)),oe=u(()=>s.value===!0?ne.value:H.value),ee=u(()=>`--q-transition-duration: ${e.transitionDuration}ms`),G=u(()=>i.value===!0&&e.seamless!==!0),de=u(()=>e.autoClose===!0?{onClick:te}:{}),C=u(()=>[`q-dialog fullscreen no-pointer-events q-dialog--${G.value===!0?"modal":"seamless"}`,l.class]);ce(i,b=>{Ee(()=>{s.value=b})}),ce(()=>e.maximized,b=>{i.value===!0&&N(b)}),ce(G,b=>{_(b),b===!0?(eo(A),Zn(E)):(Gt(A),Ct(E))});function z(b){I(),V(),J(),d=e.noRefocus===!1&&document.activeElement!==null?document.activeElement:null,N(e.maximized),B(),c.value=!0,e.noFocus!==!0&&(document.activeElement!==null&&document.activeElement.blur(),P(g)),U(()=>{if(n.proxy.$q.platform.is.ios===!0){if(e.seamless!==!0&&document.activeElement){const{top:T,bottom:ie}=document.activeElement.getBoundingClientRect(),{innerHeight:be}=window,ue=window.visualViewport!==void 0?window.visualViewport.height:be;T>0&&ie>ue/2&&(document.scrollingElement.scrollTop=Math.min(document.scrollingElement.scrollHeight-ue,ie>=be?1/0:Math.ceil(document.scrollingElement.scrollTop+ie-ue/2))),document.activeElement.scrollIntoView()}y=!0,r.value.click(),y=!1}B(!0),c.value=!1,o("show",b)},e.transitionDuration)}function ve(b){I(),V(),le(),k(!0),c.value=!0,F(),d!==null&&(d.focus(),d=null),U(()=>{F(!0),c.value=!1,o("hide",b)},e.transitionDuration)}function g(b){Qt(()=>{let T=r.value;T===null||T.contains(document.activeElement)===!0||(T=T.querySelector(b||"[autofocus], [data-autofocus]")||T,T.focus({preventScroll:!0}))})}function p(){g(),o("shake");const b=r.value;b!==null&&(b.classList.remove("q-animate--scale"),b.classList.add("q-animate--scale"),clearTimeout(h),h=setTimeout(()=>{r.value!==null&&(b.classList.remove("q-animate--scale"),g())},170))}function E(){e.seamless!==!0&&(e.persistent===!0||e.noEscDismiss===!0?e.maximized!==!0&&e.noShake!==!0&&p():(o("escape-key"),D()))}function k(b){clearTimeout(h),(b===!0||i.value===!0)&&(N(!1),e.seamless!==!0&&(_(!1),Gt(A),Ct(E))),b!==!0&&(d=null)}function N(b){b===!0?x!==!0&&(xt<1&&document.body.classList.add("q-body--dialog"),xt++,x=!0):x===!0&&(xt<2&&document.body.classList.remove("q-body--dialog"),xt--,x=!1)}function te(b){y!==!0&&(D(b),o("click",b))}function L(b){e.persistent!==!0&&e.noBackdropDismiss!==!0?D(b):e.noShake!==!0&&p()}function A(b){e.allowFocusOutside!==!0&&R.value===!0&&In(r.value,b.target)!==!0&&g('[tabindex]:not([tabindex="-1"])')}Object.assign(n.proxy,{focus:g,shake:p,__updateRefocusTarget(b){d=b||null}}),Be(k);function K(){return m("div",{...l,class:C.value},[m(wt,{name:"q-transition--fade",appear:!0},()=>G.value===!0?m("div",{class:"q-dialog__backdrop fixed-full",style:ee.value,"aria-hidden":"true",onMousedown:L}):null),m(wt,{name:oe.value,appear:!0},()=>i.value===!0?m("div",{ref:r,class:Z.value,style:ee.value,tabindex:-1,...de.value},Ze(t.default)):null)])}return $}});let Tt=!1;{const e=document.createElement("div"),t=document.createElement("div");e.setAttribute("dir","rtl"),e.style.width="1px",e.style.height="1px",e.style.overflow="auto",t.style.width="1000px",t.style.height="1px",document.body.appendChild(e),e.appendChild(t),e.scrollLeft=-1e3,Tt=e.scrollLeft>=0,e.remove()}const xe=1e3,ql=["start","center","end","start-force","center-force","end-force"],to=Array.prototype.filter,Ml=window.getComputedStyle(document.body).overflowAnchor===void 0?Dn:function(e,t){e!==null&&(cancelAnimationFrame(e._qOverflowAnimationFrame),e._qOverflowAnimationFrame=requestAnimationFrame(()=>{if(e===null)return;const o=e.children||[];to.call(o,n=>n.dataset&&n.dataset.qVsAnchor!==void 0).forEach(n=>{delete n.dataset.qVsAnchor});const l=o[t];l&&l.dataset&&(l.dataset.qVsAnchor="")}))};function et(e,t){return e+t}function $t(e,t,o,l,n,r,i,s){const c=e===window?document.scrollingElement||document.documentElement:e,h=n===!0?"offsetWidth":"offsetHeight",d={scrollStart:0,scrollViewSize:-i-s,scrollMaxSize:0,offsetStart:-i,offsetEnd:-s};if(n===!0?(e===window?(d.scrollStart=window.pageXOffset||window.scrollX||document.body.scrollLeft||0,d.scrollViewSize+=document.documentElement.clientWidth):(d.scrollStart=c.scrollLeft,d.scrollViewSize+=c.clientWidth),d.scrollMaxSize=c.scrollWidth,r===!0&&(d.scrollStart=(Tt===!0?d.scrollMaxSize-d.scrollViewSize:0)-d.scrollStart)):(e===window?(d.scrollStart=window.pageYOffset||window.scrollY||document.body.scrollTop||0,d.scrollViewSize+=document.documentElement.clientHeight):(d.scrollStart=c.scrollTop,d.scrollViewSize+=c.clientHeight),d.scrollMaxSize=c.scrollHeight),o!==null)for(let x=o.previousElementSibling;x!==null;x=x.previousElementSibling)x.classList.contains("q-virtual-scroll--skip")===!1&&(d.offsetStart+=x[h]);if(l!==null)for(let x=l.nextElementSibling;x!==null;x=x.nextElementSibling)x.classList.contains("q-virtual-scroll--skip")===!1&&(d.offsetEnd+=x[h]);if(t!==e){const x=c.getBoundingClientRect(),y=t.getBoundingClientRect();n===!0?(d.offsetStart+=y.left-x.left,d.offsetEnd-=y.width):(d.offsetStart+=y.top-x.top,d.offsetEnd-=y.height),e!==window&&(d.offsetStart+=d.scrollStart),d.offsetEnd+=d.scrollMaxSize-d.offsetStart}return d}function Rn(e,t,o,l){t==="end"&&(t=(e===window?document.body:e)[o===!0?"scrollWidth":"scrollHeight"]),e===window?o===!0?(l===!0&&(t=(Tt===!0?document.body.scrollWidth-document.documentElement.clientWidth:0)-t),window.scrollTo(t,window.pageYOffset||window.scrollY||document.body.scrollTop||0)):window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,t):o===!0?(l===!0&&(t=(Tt===!0?e.scrollWidth-e.offsetWidth:0)-t),e.scrollLeft=t):e.scrollTop=t}function ut(e,t,o,l){if(o>=l)return 0;const n=t.length,r=Math.floor(o/xe),i=Math.floor((l-1)/xe)+1;let s=e.slice(r,i).reduce(et,0);return o%xe!==0&&(s-=t.slice(r*xe,o).reduce(et,0)),l%xe!==0&&l!==n&&(s-=t.slice(l,i*xe).reduce(et,0)),s}const Vl={virtualScrollSliceSize:{type:[Number,String],default:null},virtualScrollSliceRatioBefore:{type:[Number,String],default:1},virtualScrollSliceRatioAfter:{type:[Number,String],default:1},virtualScrollItemSize:{type:[Number,String],default:24},virtualScrollStickySizeStart:{type:[Number,String],default:0},virtualScrollStickySizeEnd:{type:[Number,String],default:0},tableColspan:[Number,String]},Pl={virtualScrollHorizontal:Boolean,onVirtualScroll:Function,...Vl};function Ll({virtualScrollLength:e,getVirtualScrollTarget:t,getVirtualScrollEl:o,virtualScrollItemSizeComputed:l}){const n=Ce(),{props:r,emit:i,proxy:s}=n,{$q:c}=s;let h,d,x,y=[],v;const _=M(0),U=M(0),I=M({}),P=M(null),V=M(null),B=M(null),F=M({from:0,to:0}),R=u(()=>r.tableColspan!==void 0?r.tableColspan:100);l===void 0&&(l=u(()=>r.virtualScrollItemSize));const $=u(()=>l.value+";"+r.virtualScrollHorizontal),D=u(()=>$.value+";"+r.virtualScrollSliceRatioBefore+";"+r.virtualScrollSliceRatioAfter);ce(D,()=>{de()}),ce($,J);function J(){G(d,!0)}function le(p){G(p===void 0?d:p)}function Z(p,E){const k=t();if(k==null||k.nodeType===8)return;const N=$t(k,o(),P.value,V.value,r.virtualScrollHorizontal,c.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd);x!==N.scrollViewSize&&de(N.scrollViewSize),ne(k,N,Math.min(e.value-1,Math.max(0,parseInt(p,10)||0)),0,ql.indexOf(E)>-1?E:d>-1&&p>d?"end":"start")}function H(){const p=t();if(p==null||p.nodeType===8)return;const E=$t(p,o(),P.value,V.value,r.virtualScrollHorizontal,c.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd),k=e.value-1,N=E.scrollMaxSize-E.offsetStart-E.offsetEnd-U.value;if(h===E.scrollStart)return;if(E.scrollMaxSize<=0){ne(p,E,0,0);return}x!==E.scrollViewSize&&de(E.scrollViewSize),oe(F.value.from);const te=Math.floor(E.scrollMaxSize-Math.max(E.scrollViewSize,E.offsetEnd)-Math.min(v[k],E.scrollViewSize/2));if(te>0&&Math.ceil(E.scrollStart)>=te){ne(p,E,k,E.scrollMaxSize-E.offsetEnd-y.reduce(et,0));return}let L=0,A=E.scrollStart-E.offsetStart,K=A;if(A<=N&&A+E.scrollViewSize>=_.value)A-=_.value,L=F.value.from,K=A;else for(let b=0;A>=y[b]&&L<k;b++)A-=y[b],L+=xe;for(;A>0&&L<k;)A-=v[L],A>-E.scrollViewSize?(L++,K=A):K=v[L]+A;ne(p,E,L,K)}function ne(p,E,k,N,te){const L=typeof te=="string"&&te.indexOf("-force")>-1,A=L===!0?te.replace("-force",""):te,K=A!==void 0?A:"start";let b=Math.max(0,k-I.value[K]),T=b+I.value.total;T>e.value&&(T=e.value,b=Math.max(0,T-I.value.total)),h=E.scrollStart;const ie=b!==F.value.from||T!==F.value.to;if(ie===!1&&A===void 0){z(k);return}const{activeElement:be}=document,ue=B.value;ie===!0&&ue!==null&&ue!==be&&ue.contains(be)===!0&&(ue.addEventListener("focusout",ee),setTimeout(()=>{ue!==null&&ue.removeEventListener("focusout",ee)})),Ml(ue,k-b);const Ve=A!==void 0?v.slice(b,k).reduce(et,0):0;if(ie===!0){const Re=T>=F.value.from&&b<=F.value.to?F.value.to:T;F.value={from:b,to:Re},_.value=ut(y,v,0,b),U.value=ut(y,v,T,e.value),requestAnimationFrame(()=>{F.value.to!==T&&h===E.scrollStart&&(F.value={from:F.value.from,to:T},U.value=ut(y,v,T,e.value))})}requestAnimationFrame(()=>{if(h!==E.scrollStart)return;ie===!0&&oe(b);const Re=v.slice(b,k).reduce(et,0),Te=Re+E.offsetStart+_.value,Pe=Te+v[k];let Le=Te+N;if(A!==void 0){const ge=Re-Ve,re=E.scrollStart+ge;Le=L!==!0&&re<Te&&Pe<re+E.scrollViewSize?re:A==="end"?Pe-E.scrollViewSize:Te-(A==="start"?0:Math.round((E.scrollViewSize-v[k])/2))}h=Le,Rn(p,Le,r.virtualScrollHorizontal,c.lang.rtl),z(k)})}function oe(p){const E=B.value;if(E){const k=to.call(E.children,b=>b.classList&&b.classList.contains("q-virtual-scroll--skip")===!1),N=k.length,te=r.virtualScrollHorizontal===!0?b=>b.getBoundingClientRect().width:b=>b.offsetHeight;let L=p,A,K;for(let b=0;b<N;){for(A=te(k[b]),b++;b<N&&k[b].classList.contains("q-virtual-scroll--with-prev")===!0;)A+=te(k[b]),b++;K=A-v[L],K!==0&&(v[L]+=K,y[Math.floor(L/xe)]+=K),L++}}}function ee(){B.value!==null&&B.value!==void 0&&B.value.focus()}function G(p,E){const k=1*l.value;(E===!0||Array.isArray(v)===!1)&&(v=[]);const N=v.length;v.length=e.value;for(let L=e.value-1;L>=N;L--)v[L]=k;const te=Math.floor((e.value-1)/xe);y=[];for(let L=0;L<=te;L++){let A=0;const K=Math.min((L+1)*xe,e.value);for(let b=L*xe;b<K;b++)A+=v[b];y.push(A)}d=-1,h=void 0,_.value=ut(y,v,0,F.value.from),U.value=ut(y,v,F.value.to,e.value),p>=0?(oe(F.value.from),Ee(()=>{Z(p)})):ve()}function de(p){if(p===void 0&&typeof window!="undefined"){const A=t();A!=null&&A.nodeType!==8&&(p=$t(A,o(),P.value,V.value,r.virtualScrollHorizontal,c.lang.rtl,r.virtualScrollStickySizeStart,r.virtualScrollStickySizeEnd).scrollViewSize)}x=p;const E=parseFloat(r.virtualScrollSliceRatioBefore)||0,k=parseFloat(r.virtualScrollSliceRatioAfter)||0,N=1+E+k,te=p===void 0||p<=0?1:Math.ceil(p/l.value),L=Math.max(1,te,Math.ceil((r.virtualScrollSliceSize>0?r.virtualScrollSliceSize:10)/N));I.value={total:Math.ceil(L*N),start:Math.ceil(L*E),center:Math.ceil(L*(.5+E)),end:Math.ceil(L*(1+E)),view:te}}function C(p,E){const k=r.virtualScrollHorizontal===!0?"width":"height",N={["--q-virtual-scroll-item-"+k]:l.value+"px"};return[p==="tbody"?m(p,{class:"q-virtual-scroll__padding",key:"before",ref:P},[m("tr",[m("td",{style:{[k]:`${_.value}px`,...N},colspan:R.value})])]):m(p,{class:"q-virtual-scroll__padding",key:"before",ref:P,style:{[k]:`${_.value}px`,...N}}),m(p,{class:"q-virtual-scroll__content",key:"content",ref:B,tabindex:-1},E.flat()),p==="tbody"?m(p,{class:"q-virtual-scroll__padding",key:"after",ref:V},[m("tr",[m("td",{style:{[k]:`${U.value}px`,...N},colspan:R.value})])]):m(p,{class:"q-virtual-scroll__padding",key:"after",ref:V,style:{[k]:`${U.value}px`,...N}})]}function z(p){d!==p&&(r.onVirtualScroll!==void 0&&i("virtual-scroll",{index:p,from:F.value.from,to:F.value.to-1,direction:p<d?"decrease":"increase",ref:s}),d=p)}de();const ve=qn(H,c.platform.is.ios===!0?120:35);Co(()=>{de()});let g=!1;return Vn(()=>{g=!0}),Pn(()=>{if(g!==!0)return;const p=t();h!==void 0&&p!==void 0&&p!==null&&p.nodeType!==8?Rn(p,h,r.virtualScrollHorizontal,c.lang.rtl):Z(d)}),Be(()=>{ve.cancel()}),Object.assign(s,{scrollTo:Z,reset:J,refresh:le}),{virtualScrollSliceRange:F,virtualScrollSliceSizeComputed:I,setVirtualScrollSize:de,onVirtualScrollEvt:ve,localResetVirtualScroll:G,padVirtualScroll:C,scrollTo:Z,reset:J,refresh:le}}const no={name:String};function Dl(e){return u(()=>({type:"hidden",name:e.name,value:e.modelValue}))}function Il(e={}){return(t,o,l)=>{t[o](m("input",{class:"hidden"+(l||""),...e.value}))}}function zl(e){return u(()=>e.name||e.for)}const Ol=/[\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uff9f\u4e00-\u9faf\u3400-\u4dbf]/,$l=/[\u4e00-\u9fff\u3400-\u4dbf\u{20000}-\u{2a6df}\u{2a700}-\u{2b73f}\u{2b740}-\u{2b81f}\u{2b820}-\u{2ceaf}\uf900-\ufaff\u3300-\u33ff\ufe30-\ufe4f\uf900-\ufaff\u{2f800}-\u{2fa1f}]/u,Ul=/[\u3131-\u314e\u314f-\u3163\uac00-\ud7a3]/,Nl=/[a-z0-9_ -]$/i;function Hl(e){return function(o){if(o.type==="compositionend"||o.type==="change"){if(o.target.qComposing!==!0)return;o.target.qComposing=!1,e(o)}else o.type==="compositionupdate"&&o.target.qComposing!==!0&&typeof o.data=="string"&&(pe.is.firefox===!0?Nl.test(o.data)===!1:Ol.test(o.data)===!0||$l.test(o.data)===!0||Ul.test(o.data)===!0)===!0&&(o.target.qComposing=!0)}}const An=e=>["add","add-unique","toggle"].includes(e),Xl=".*+?^${}()|[]\\",jl=Object.keys(Zt);var Wl=nt({name:"QSelect",inheritAttrs:!1,props:{...Pl,...no,...Zt,modelValue:{required:!0},multiple:Boolean,displayValue:[String,Number],displayValueHtml:Boolean,dropdownIcon:String,options:{type:Array,default:()=>[]},optionValue:[Function,String],optionLabel:[Function,String],optionDisable:[Function,String],hideSelected:Boolean,hideDropdownIcon:Boolean,fillInput:Boolean,maxValues:[Number,String],optionsDense:Boolean,optionsDark:{type:Boolean,default:null},optionsSelectedClass:String,optionsHtml:Boolean,optionsCover:Boolean,menuShrink:Boolean,menuAnchor:String,menuSelf:String,menuOffset:Array,popupContentClass:String,popupContentStyle:[String,Array,Object],useInput:Boolean,useChips:Boolean,newValueMode:{type:String,validator:An},mapOptions:Boolean,emitValue:Boolean,inputDebounce:{type:[Number,String],default:500},inputClass:[Array,String,Object],inputStyle:[Array,String,Object],tabindex:{type:[String,Number],default:0},autocomplete:String,transitionShow:String,transitionHide:String,transitionDuration:[String,Number],behavior:{type:String,validator:e=>["default","menu","dialog"].includes(e),default:"default"},virtualScrollItemSize:{type:[Number,String],default:void 0},onNewValue:Function,onFilter:Function},emits:[...Gn,"add","remove","input-value","new-value","keyup","keypress","keydown","filter-abort"],setup(e,{slots:t,emit:o}){const{proxy:l}=Ce(),{$q:n}=l,r=M(!1),i=M(!1),s=M(-1),c=M(""),h=M(!1),d=M(!1);let x,y,v,_,U,I,P,V,B;const F=M(null),R=M(null),$=M(null),D=M(null),J=M(null),le=zl(e),Z=Hl(tn),H=u(()=>Array.isArray(e.options)?e.options.length:0),ne=u(()=>e.virtualScrollItemSize===void 0?e.optionsDense===!0?24:48:e.virtualScrollItemSize),{virtualScrollSliceRange:oe,virtualScrollSliceSizeComputed:ee,localResetVirtualScroll:G,padVirtualScroll:de,onVirtualScrollEvt:C,scrollTo:z,setVirtualScrollSize:ve}=Ll({virtualScrollLength:H,getVirtualScrollTarget:lt,getVirtualScrollEl:je,virtualScrollItemSizeComputed:ne}),g=Kn(),p=u(()=>{const a=e.mapOptions===!0&&e.multiple!==!0,w=e.modelValue!==void 0&&(e.modelValue!==null||a===!0)?e.multiple===!0&&Array.isArray(e.modelValue)?e.modelValue:[e.modelValue]:[];if(e.mapOptions===!0&&Array.isArray(e.options)===!0){const S=e.mapOptions===!0&&y!==void 0?y:[],q=w.map(Q=>At(Q,S));return e.modelValue===null&&a===!0?q.filter(Q=>Q!==null):q}return w}),E=u(()=>{const a={};return jl.forEach(w=>{const S=e[w];S!==void 0&&(a[w]=S)}),a}),k=u(()=>e.optionsDark===null?g.isDark.value:e.optionsDark),N=u(()=>Wt(p.value)),te=u(()=>{let a="q-field__input q-placeholder col";return e.hideSelected===!0||p.value.length===0?[a,e.inputClass]:(a+=" q-field__input--padding",e.inputClass===void 0?a:[a,e.inputClass])}),L=u(()=>(e.virtualScrollHorizontal===!0?"q-virtual-scroll--horizontal":"")+(e.popupContentClass?" "+e.popupContentClass:"")),A=u(()=>H.value===0),K=u(()=>p.value.map(a=>re.value(a)).join(", ")),b=u(()=>e.optionsHtml===!0?()=>!0:a=>a!=null&&a.html===!0),T=u(()=>e.displayValueHtml===!0||e.displayValue===void 0&&(e.optionsHtml===!0||p.value.some(b.value))),ie=u(()=>g.focused.value===!0?e.tabindex:-1),be=u(()=>{const a={tabindex:e.tabindex,role:"combobox","aria-label":e.label,"aria-autocomplete":e.useInput===!0?"list":"none","aria-expanded":r.value===!0?"true":"false","aria-owns":`${g.targetUid.value}_lb`,"aria-controls":`${g.targetUid.value}_lb`};return s.value>=0&&(a["aria-activedescendant"]=`${g.targetUid.value}_${s.value}`),a}),ue=u(()=>{const a={id:`${g.targetUid.value}_lb`,role:"listbox","aria-multiselectable":e.multiple===!0?"true":"false"};return s.value>=0&&(a["aria-activedescendant"]=`${g.targetUid.value}_${s.value}`),a}),Ve=u(()=>p.value.map((a,w)=>({index:w,opt:a,html:b.value(a),selected:!0,removeAtIndex:Rt,toggleOption:Ae,tabindex:ie.value}))),Re=u(()=>{if(H.value===0)return[];const{from:a,to:w}=oe.value;return e.options.slice(a,w).map((S,q)=>{const Q=Fe.value(S)===!0,X=a+q,ae={clickable:!0,active:!1,activeClass:Le.value,manualFocus:!0,focused:!1,disable:Q,tabindex:-1,dense:e.optionsDense,dark:k.value,role:"option",id:`${g.targetUid.value}_${X}`,onClick:()=>{Ae(S)}};return Q!==!0&&(f(S)===!0&&(ae.active=!0),s.value===X&&(ae.focused=!0),ae["aria-selected"]=ae.active===!0?"true":"false",n.platform.is.desktop===!0&&(ae.onMousemove=()=>{r.value===!0&&qe(X)})),{index:X,opt:S,html:b.value(S),label:re.value(S),selected:ae.active,focused:ae.focused,toggleOption:Ae,setOptionIndex:qe,itemProps:ae}})}),Te=u(()=>e.dropdownIcon!==void 0?e.dropdownIcon:n.iconSet.arrow.dropdown),Pe=u(()=>e.optionsCover===!1&&e.outlined!==!0&&e.standout!==!0&&e.borderless!==!0&&e.rounded!==!0),Le=u(()=>e.optionsSelectedClass!==void 0?e.optionsSelectedClass:e.color!==void 0?`text-${e.color}`:""),ge=u(()=>ot(e.optionValue,"value")),re=u(()=>ot(e.optionLabel,"label")),Fe=u(()=>ot(e.optionDisable,"disable")),Ue=u(()=>p.value.map(a=>ge.value(a))),_t=u(()=>{const a={onInput:tn,onChange:Z,onKeydown:Se,onKeyup:Y,onKeypress:se,onFocus:O,onClick(w){v===!0&&ke(w)}};return a.onCompositionstart=a.onCompositionupdate=a.onCompositionend=Z,a});ce(p,a=>{y=a,e.useInput===!0&&e.fillInput===!0&&e.multiple!==!0&&g.innerLoading.value!==!0&&(i.value!==!0&&r.value!==!0||N.value!==!0)&&(_!==!0&&Ye(),(i.value===!0||r.value===!0)&&We(""))},{immediate:!0}),ce(()=>e.fillInput,Ye),ce(r,kt),ce(H,go);function vt(a){return e.emitValue===!0?ge.value(a):a}function Ne(a){if(a>-1&&a<p.value.length)if(e.multiple===!0){const w=e.modelValue.slice();o("remove",{index:a,value:w.splice(a,1)[0]}),o("update:modelValue",w)}else o("update:modelValue",null)}function Rt(a){Ne(a),g.focus()}function He(a,w){const S=vt(a);if(e.multiple!==!0){e.fillInput===!0&&at(re.value(a),!0,!0),o("update:modelValue",S);return}if(p.value.length===0){o("add",{index:0,value:S}),o("update:modelValue",e.multiple===!0?[S]:S);return}if(w===!0&&f(a)===!0||e.maxValues!==void 0&&e.modelValue.length>=e.maxValues)return;const q=e.modelValue.slice();o("add",{index:q.length,value:S}),q.push(S),o("update:modelValue",q)}function Ae(a,w){if(g.editable.value!==!0||a===void 0||Fe.value(a)===!0)return;const S=ge.value(a);if(e.multiple!==!0){w!==!0&&(at(e.fillInput===!0?re.value(a):"",!0,!0),De()),R.value!==null&&R.value.focus(),(p.value.length===0||rt(ge.value(p.value[0]),S)!==!0)&&o("update:modelValue",e.emitValue===!0?S:a);return}if((v!==!0||h.value===!0)&&g.focus(),O(),p.value.length===0){const X=e.emitValue===!0?S:a;o("add",{index:0,value:X}),o("update:modelValue",e.multiple===!0?[X]:X);return}const q=e.modelValue.slice(),Q=Ue.value.findIndex(X=>rt(X,S));if(Q>-1)o("remove",{index:Q,value:q.splice(Q,1)[0]});else{if(e.maxValues!==void 0&&q.length>=e.maxValues)return;const X=e.emitValue===!0?S:a;o("add",{index:q.length,value:X}),q.push(X)}o("update:modelValue",q)}function qe(a){if(n.platform.is.desktop!==!0)return;const w=a>-1&&a<H.value?a:-1;s.value!==w&&(s.value=w)}function Xe(a=1,w){if(r.value===!0){let S=s.value;do S=Sn(S+a,-1,H.value-1);while(S!==-1&&S!==s.value&&Fe.value(e.options[S])===!0);s.value!==S&&(qe(S),z(S),w!==!0&&e.useInput===!0&&e.fillInput===!0&&mt(S>=0?re.value(e.options[S]):I))}}function At(a,w){const S=q=>rt(ge.value(q),a);return e.options.find(S)||w.find(S)||a}function ot(a,w){const S=a!==void 0?a:w;return typeof S=="function"?S:q=>q!==null&&typeof q=="object"&&S in q?q[S]:q}function f(a){const w=ge.value(a);return Ue.value.find(S=>rt(S,w))!==void 0}function O(a){e.useInput===!0&&R.value!==null&&(a===void 0||R.value===a.target&&a.target.value===K.value)&&R.value.select()}function W(a){Ln(a,27)===!0&&r.value===!0&&(ke(a),De(),Ye()),o("keyup",a)}function Y(a){const{value:w}=a.target;if(a.keyCode!==void 0){W(a);return}if(a.target.value="",clearTimeout(x),Ye(),typeof w=="string"&&w.length>0){const S=w.toLocaleLowerCase(),q=X=>{const ae=e.options.find(he=>X.value(he).toLocaleLowerCase()===S);return ae===void 0?!1:(p.value.indexOf(ae)===-1?Ae(ae):De(),!0)},Q=X=>{q(ge)!==!0&&(q(re)===!0||X===!0||We(w,!0,()=>Q(!0)))};Q()}else g.clearValue(a)}function se(a){o("keypress",a)}function Se(a){if(o("keydown",a),Eo(a)===!0)return;const w=c.value.length>0&&(e.newValueMode!==void 0||e.onNewValue!==void 0),S=a.shiftKey!==!0&&e.multiple!==!0&&(s.value>-1||w===!0);if(a.keyCode===27){_e(a);return}if(a.keyCode===9&&S===!1){Ge();return}if(a.target===void 0||a.target.id!==g.targetUid.value)return;if(a.keyCode===40&&g.innerLoading.value!==!0&&r.value===!1){ye(a),Ke();return}if(a.keyCode===8&&e.hideSelected!==!0&&c.value.length===0){e.multiple===!0&&Array.isArray(e.modelValue)===!0?Ne(e.modelValue.length-1):e.multiple!==!0&&e.modelValue!==null&&o("update:modelValue",null);return}(a.keyCode===35||a.keyCode===36)&&(typeof c.value!="string"||c.value.length===0)&&(ye(a),s.value=-1,Xe(a.keyCode===36?1:-1,e.multiple)),(a.keyCode===33||a.keyCode===34)&&ee.value!==void 0&&(ye(a),s.value=Math.max(-1,Math.min(H.value,s.value+(a.keyCode===33?-1:1)*ee.value.view)),Xe(a.keyCode===33?1:-1,e.multiple)),(a.keyCode===38||a.keyCode===40)&&(ye(a),Xe(a.keyCode===38?-1:1,e.multiple));const q=H.value;if((V===void 0||B<Date.now())&&(V=""),q>0&&e.useInput!==!0&&a.key!==void 0&&a.key.length===1&&a.altKey===a.ctrlKey&&(a.keyCode!==32||V.length>0)){r.value!==!0&&Ke(a);const Q=a.key.toLocaleLowerCase(),X=V.length===1&&V[0]===Q;B=Date.now()+1500,X===!1&&(ye(a),V+=Q);const ae=new RegExp("^"+V.split("").map(Bt=>Xl.indexOf(Bt)>-1?"\\"+Bt:Bt).join(".*"),"i");let he=s.value;if(X===!0||he<0||ae.test(re.value(e.options[he]))!==!0)do he=Sn(he+1,-1,q-1);while(he!==s.value&&(Fe.value(e.options[he])===!0||ae.test(re.value(e.options[he]))!==!0));s.value!==he&&Ee(()=>{qe(he),z(he),he>=0&&e.useInput===!0&&e.fillInput===!0&&mt(re.value(e.options[he]))});return}if(!(a.keyCode!==13&&(a.keyCode!==32||e.useInput===!0||V!=="")&&(a.keyCode!==9||S===!1))){if(a.keyCode!==9&&ye(a),s.value>-1&&s.value<q){Ae(e.options[s.value]);return}if(w===!0){const Q=(X,ae)=>{if(ae){if(An(ae)!==!0)return}else ae=e.newValueMode;if(X==null)return;at("",e.multiple!==!0,!0),(ae==="toggle"?Ae:He)(X,ae==="add-unique"),e.multiple!==!0&&(R.value!==null&&R.value.focus(),De())};if(e.onNewValue!==void 0?o("new-value",c.value,Q):Q(c.value),e.multiple!==!0)return}r.value===!0?Ge():g.innerLoading.value!==!0&&Ke()}}function je(){return v===!0?J.value:$.value!==null&&$.value.__qPortalInnerRef.value!==null?$.value.__qPortalInnerRef.value:void 0}function lt(){return je()}function lo(){return e.hideSelected===!0?[]:t["selected-item"]!==void 0?Ve.value.map(a=>t["selected-item"](a)).slice():t.selected!==void 0?[].concat(t.selected()):e.useChips===!0?Ve.value.map((a,w)=>m(Ko,{key:"option-"+w,removable:g.editable.value===!0&&Fe.value(a.opt)!==!0,dense:!0,textColor:e.color,tabindex:ie.value,onRemove(){a.removeAtIndex(w)}},()=>m("span",{class:"ellipsis",[a.html===!0?"innerHTML":"textContent"]:re.value(a.opt)}))):[m("span",{[T.value===!0?"innerHTML":"textContent"]:e.displayValue!==void 0?e.displayValue:K.value})]}function en(){if(A.value===!0)return t["no-option"]!==void 0?t["no-option"]({inputValue:c.value}):void 0;const a=t.option!==void 0?t.option:S=>m(el,{key:S.index,...S.itemProps},()=>m(Zo,()=>m(Jo,()=>m("span",{[S.html===!0?"innerHTML":"textContent"]:S.label}))));let w=de("div",Re.value.map(a));return t["before-options"]!==void 0&&(w=t["before-options"]().concat(w)),Do(t["after-options"],w)}function ao(a,w){const S=w===!0?{...be.value,...g.splitAttrs.attributes.value}:void 0,q={ref:w===!0?R:void 0,key:"i_t",class:te.value,style:e.inputStyle,value:c.value!==void 0?c.value:"",type:"search",...S,id:w===!0?g.targetUid.value:void 0,maxlength:e.maxlength,autocomplete:e.autocomplete,"data-autofocus":a!==!0&&e.autofocus===!0||void 0,disabled:e.disable===!0,readonly:e.readonly===!0,..._t.value};return a!==!0&&v===!0&&(Array.isArray(q.class)===!0?q.class=[...q.class,"no-pointer-events"]:q.class+=" no-pointer-events"),m("input",q)}function tn(a){clearTimeout(x),!(a&&a.target&&a.target.qComposing===!0)&&(mt(a.target.value||""),_=!0,I=c.value,g.focused.value!==!0&&(v!==!0||h.value===!0)&&g.focus(),e.onFilter!==void 0&&(x=setTimeout(()=>{We(c.value)},e.inputDebounce)))}function mt(a){c.value!==a&&(c.value=a,o("input-value",a))}function at(a,w,S){_=S!==!0,e.useInput===!0&&(mt(a),(w===!0||S!==!0)&&(I=a),w!==!0&&We(a))}function We(a,w,S){if(e.onFilter===void 0||w!==!0&&g.focused.value!==!0)return;g.innerLoading.value===!0?o("filter-abort"):(g.innerLoading.value=!0,d.value=!0),a!==""&&e.multiple!==!0&&p.value.length>0&&_!==!0&&a===re.value(p.value[0])&&(a="");const q=setTimeout(()=>{r.value===!0&&(r.value=!1)},10);clearTimeout(U),U=q,o("filter",a,(Q,X)=>{(w===!0||g.focused.value===!0)&&U===q&&(clearTimeout(U),typeof Q=="function"&&Q(),d.value=!1,Ee(()=>{g.innerLoading.value=!1,g.editable.value===!0&&(w===!0?r.value===!0&&De():r.value===!0?kt(!0):r.value=!0),typeof X=="function"&&Ee(()=>{X(l)}),typeof S=="function"&&Ee(()=>{S(l)})}))},()=>{g.focused.value===!0&&U===q&&(clearTimeout(U),g.innerLoading.value=!1,d.value=!1),r.value===!0&&(r.value=!1)})}function ro(){return m(Tl,{ref:$,class:L.value,style:e.popupContentStyle,modelValue:r.value,fit:e.menuShrink!==!0,cover:e.optionsCover===!0&&A.value!==!0&&e.useInput!==!0,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,dark:k.value,noParentEvent:!0,noRefocus:!0,noFocus:!0,square:Pe.value,transitionShow:e.transitionShow,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,separateClosePopup:!0,...ue.value,onScrollPassive:C,onBeforeShow:on,onBeforeHide:io,onShow:uo},en)}function io(a){ln(a),Ge()}function uo(){ve()}function so(a){ke(a),R.value!==null&&R.value.focus(),h.value=!0,window.scrollTo(window.pageXOffset||window.scrollX||document.body.scrollLeft||0,0)}function co(a){ke(a),Ee(()=>{h.value=!1})}function fo(){const a=[m(yl,{class:`col-auto ${g.fieldClass.value}`,...E.value,for:g.targetUid.value,dark:k.value,square:!0,loading:d.value,itemAligned:!1,filled:!0,stackLabel:c.value.length>0,...g.splitAttrs.listeners.value,onFocus:so,onBlur:co},{...t,rawControl:()=>g.getControl(!0),before:void 0,after:void 0})];return r.value===!0&&a.push(m("div",{ref:J,class:L.value+" scroll",style:e.popupContentStyle,...ue.value,onClick:_e,onScrollPassive:C},en())),m(Fl,{ref:D,modelValue:i.value,position:e.useInput===!0?"top":void 0,transitionShow:P,transitionHide:e.transitionHide,transitionDuration:e.transitionDuration,onBeforeShow:on,onBeforeHide:vo,onHide:mo,onShow:ho},()=>m("div",{class:"q-select__dialog"+(k.value===!0?" q-select__dialog--dark q-dark":"")+(h.value===!0?" q-select__dialog--focused":"")},a))}function vo(a){ln(a),D.value!==null&&D.value.__updateRefocusTarget(g.rootRef.value.querySelector(".q-field__native > [tabindex]:last-child")),g.focused.value=!1}function mo(a){De(),g.focused.value===!1&&o("blur",a),Ye()}function ho(){const a=document.activeElement;(a===null||a.id!==g.targetUid.value)&&R.value!==null&&R.value!==a&&R.value.focus(),ve()}function Ge(){i.value!==!0&&(s.value=-1,r.value===!0&&(r.value=!1),g.focused.value===!1&&(clearTimeout(U),U=void 0,g.innerLoading.value===!0&&(o("filter-abort"),g.innerLoading.value=!1,d.value=!1)))}function Ke(a){g.editable.value===!0&&(v===!0?(g.onControlFocusin(a),i.value=!0,Ee(()=>{g.focus()})):g.focus(),e.onFilter!==void 0?We(c.value):(A.value!==!0||t["no-option"]!==void 0)&&(r.value=!0))}function De(){i.value=!1,Ge()}function Ye(){e.useInput===!0&&at(e.multiple!==!0&&e.fillInput===!0&&p.value.length>0&&re.value(p.value[0])||"",!0,!0)}function kt(a){let w=-1;if(a===!0){if(p.value.length>0){const S=ge.value(p.value[0]);w=e.options.findIndex(q=>rt(ge.value(q),S))}G(w)}qe(w)}function go(a,w){r.value===!0&&g.innerLoading.value===!1&&(G(-1,!0),Ee(()=>{r.value===!0&&g.innerLoading.value===!1&&(a>w?G():kt(!0))}))}function nn(){i.value===!1&&$.value!==null&&$.value.updatePosition()}function on(a){a!==void 0&&ke(a),o("popup-show",a),g.hasPopupOpen=!0,g.onControlFocusin(a)}function ln(a){a!==void 0&&ke(a),o("popup-hide",a),g.hasPopupOpen=!1,g.onControlFocusout(a)}function an(){v=n.platform.is.mobile!==!0&&e.behavior!=="dialog"?!1:e.behavior!=="menu"&&(e.useInput===!0?t["no-option"]!==void 0||e.onFilter!==void 0||A.value===!1:!0),P=n.platform.is.ios===!0&&v===!0&&e.useInput===!0?"fade":e.transitionShow}return Mn(an),To(nn),an(),Be(()=>{clearTimeout(x)}),Object.assign(l,{showPopup:Ke,hidePopup:De,removeAtIndex:Ne,add:He,toggleOption:Ae,getOptionIndex:()=>s.value,setOptionIndex:qe,moveOptionSelection:Xe,filter:We,updateMenuPosition:nn,updateInputValue:at,isOptionSelected:f,getEmittingOptionValue:vt,isOptionDisabled:(...a)=>Fe.value.apply(null,a)===!0,getOptionValue:(...a)=>ge.value.apply(null,a),getOptionLabel:(...a)=>re.value.apply(null,a)}),Object.assign(g,{innerValue:p,fieldClass:u(()=>`q-select q-field--auto-height q-select--with${e.useInput!==!0?"out":""}-input q-select--with${e.useChips!==!0?"out":""}-chips q-select--${e.multiple===!0?"multiple":"single"}`),inputRef:F,targetRef:R,hasValue:N,showPopup:Ke,floatingLabel:u(()=>e.hideSelected!==!0&&N.value===!0||typeof c.value=="number"||c.value.length>0||Wt(e.displayValue)),getControlChild:()=>{if(g.editable.value!==!1&&(i.value===!0||A.value!==!0||t["no-option"]!==void 0))return v===!0?fo():ro();g.hasPopupOpen===!0&&(g.hasPopupOpen=!1)},controlEvents:{onFocusin(a){g.onControlFocusin(a)},onFocusout(a){g.onControlFocusout(a,()=>{Ye(),Ge()})},onClick(a){if(_e(a),v!==!0&&r.value===!0){Ge(),R.value!==null&&R.value.focus();return}Ke(a)}},getControl:a=>{const w=lo(),S=a===!0||i.value!==!0||v!==!0;if(e.useInput===!0)w.push(ao(a,S));else if(g.editable.value===!0){const Q=S===!0?be.value:void 0;w.push(m("input",{ref:S===!0?R:void 0,key:"d_t",class:"q-select__focus-target",id:S===!0?g.targetUid.value:void 0,readonly:!0,"data-autofocus":a!==!0&&e.autofocus===!0||void 0,...Q,onKeydown:Se,onKeyup:W,onKeypress:se})),S===!0&&typeof e.autocomplete=="string"&&e.autocomplete.length>0&&w.push(m("input",{class:"q-select__autocomplete-input",autocomplete:e.autocomplete,tabindex:-1,onKeyup:Y}))}if(le.value!==void 0&&e.disable!==!0&&Ue.value.length>0){const Q=Ue.value.map(X=>m("option",{value:X,selected:!0}));w.push(m("select",{class:"hidden",name:le.value,multiple:e.multiple},Q))}const q=e.useInput===!0||S!==!0?void 0:g.splitAttrs.attributes.value;return m("div",{class:"q-field__native row items-center",...q},w)},getInnerAppend:()=>e.loading!==!0&&d.value!==!0&&e.hideDropdownIcon!==!0?[m(Ht,{class:"q-select__dropdown-icon"+(r.value===!0?" rotate-180":""),name:Te.value})]:null}),Yn(g)}});function Ut(e,t,o){const l=ft(e);let n,r=l.left-t.event.x,i=l.top-t.event.y,s=Math.abs(r),c=Math.abs(i);const h=t.direction;h.horizontal===!0&&h.vertical!==!0?n=r<0?"left":"right":h.horizontal!==!0&&h.vertical===!0?n=i<0?"up":"down":h.up===!0&&i<0?(n="up",s>c&&(h.left===!0&&r<0?n="left":h.right===!0&&r>0&&(n="right"))):h.down===!0&&i>0?(n="down",s>c&&(h.left===!0&&r<0?n="left":h.right===!0&&r>0&&(n="right"))):h.left===!0&&r<0?(n="left",s<c&&(h.up===!0&&i<0?n="up":h.down===!0&&i>0&&(n="down"))):h.right===!0&&r>0&&(n="right",s<c&&(h.up===!0&&i<0?n="up":h.down===!0&&i>0&&(n="down")));let d=!1;if(n===void 0&&o===!1){if(t.event.isFirst===!0||t.event.lastDir===void 0)return{};n=t.event.lastDir,d=!0,n==="left"||n==="right"?(l.left-=r,s=0,r=0):(l.top-=i,c=0,i=0)}return{synthetic:d,payload:{evt:e,touch:t.event.mouse!==!0,mouse:t.event.mouse===!0,position:l,direction:n,isFirst:t.event.isFirst,isFinal:o===!0,duration:Date.now()-t.event.time,distance:{x:s,y:c},offset:{x:r,y:i},delta:{x:l.left-t.event.lastX,y:l.top-t.event.lastY}}}}let Gl=0;var Kl=Io({name:"touch-pan",beforeMount(e,{value:t,modifiers:o}){if(o.mouse!==!0&&pe.has.touch!==!0)return;function l(r,i){o.mouse===!0&&i===!0?ye(r):(o.stop===!0&&ke(r),o.prevent===!0&&_e(r))}const n={uid:"qvtp_"+Gl++,handler:t,modifiers:o,direction:mn(o),noop:Dn,mouseStart(r){hn(r,n)&&_o(r)&&(ht(n,"temp",[[document,"mousemove","move","notPassiveCapture"],[document,"mouseup","end","passiveCapture"]]),n.start(r,!0))},touchStart(r){if(hn(r,n)){const i=r.target;ht(n,"temp",[[i,"touchmove","move","notPassiveCapture"],[i,"touchcancel","end","passiveCapture"],[i,"touchend","end","passiveCapture"]]),n.start(r)}},start(r,i){if(pe.is.firefox===!0&&Ft(e,!0),n.lastEvt=r,i===!0||o.stop===!0){if(n.direction.all!==!0&&(i!==!0||n.modifiers.mouseAllDir!==!0)){const h=r.type.indexOf("mouse")>-1?new MouseEvent(r.type,r):new TouchEvent(r.type,r);r.defaultPrevented===!0&&_e(h),r.cancelBubble===!0&&ke(h),Object.assign(h,{qKeyEvent:r.qKeyEvent,qClickOutside:r.qClickOutside,qAnchorHandled:r.qAnchorHandled,qClonedBy:r.qClonedBy===void 0?[n.uid]:r.qClonedBy.concat(n.uid)}),n.initialEvent={target:r.target,event:h}}ke(r)}const{left:s,top:c}=ft(r);n.event={x:s,y:c,time:Date.now(),mouse:i===!0,detected:!1,isFirst:!0,isFinal:!1,lastX:s,lastY:c}},move(r){if(n.event===void 0)return;const i=ft(r),s=i.left-n.event.x,c=i.top-n.event.y;if(s===0&&c===0)return;n.lastEvt=r;const h=n.event.mouse===!0,d=()=>{l(r,h),o.preserveCursor!==!0&&(document.documentElement.style.cursor="grabbing"),h===!0&&document.body.classList.add("no-pointer-events--children"),document.body.classList.add("non-selectable"),al(),n.styleCleanup=v=>{if(n.styleCleanup=void 0,o.preserveCursor!==!0&&(document.documentElement.style.cursor=""),document.body.classList.remove("non-selectable"),h===!0){const _=()=>{document.body.classList.remove("no-pointer-events--children")};v!==void 0?setTimeout(()=>{_(),v()},50):_()}else v!==void 0&&v()}};if(n.event.detected===!0){n.event.isFirst!==!0&&l(r,n.event.mouse);const{payload:v,synthetic:_}=Ut(r,n,!1);v!==void 0&&(n.handler(v)===!1?n.end(r):(n.styleCleanup===void 0&&n.event.isFirst===!0&&d(),n.event.lastX=v.position.left,n.event.lastY=v.position.top,n.event.lastDir=_===!0?void 0:v.direction,n.event.isFirst=!1));return}if(n.direction.all===!0||h===!0&&n.modifiers.mouseAllDir===!0){d(),n.event.detected=!0,n.move(r);return}const x=Math.abs(s),y=Math.abs(c);x!==y&&(n.direction.horizontal===!0&&x>y||n.direction.vertical===!0&&x<y||n.direction.up===!0&&x<y&&c<0||n.direction.down===!0&&x<y&&c>0||n.direction.left===!0&&x>y&&s<0||n.direction.right===!0&&x>y&&s>0?(n.event.detected=!0,n.move(r)):n.end(r,!0))},end(r,i){if(n.event!==void 0){if(qt(n,"temp"),pe.is.firefox===!0&&Ft(e,!1),i===!0)n.styleCleanup!==void 0&&n.styleCleanup(),n.event.detected!==!0&&n.initialEvent!==void 0&&n.initialEvent.target.dispatchEvent(n.initialEvent.event);else if(n.event.detected===!0){n.event.isFirst===!0&&n.handler(Ut(r===void 0?n.lastEvt:r,n).payload);const{payload:s}=Ut(r===void 0?n.lastEvt:r,n,!0),c=()=>{n.handler(s)};n.styleCleanup!==void 0?n.styleCleanup(c):c()}n.event=void 0,n.initialEvent=void 0,n.lastEvt=void 0}}};e.__qtouchpan=n,o.mouse===!0&&ht(n,"main",[[e,"mousedown","mouseStart",`passive${o.mouseCapture===!0?"Capture":""}`]]),pe.has.touch===!0&&ht(n,"main",[[e,"touchstart","touchStart",`passive${o.capture===!0?"Capture":""}`],[e,"touchmove","noop","notPassiveCapture"]])},updated(e,t){const o=e.__qtouchpan;o!==void 0&&(t.oldValue!==t.value&&(typeof value!="function"&&o.end(),o.handler=t.value),o.direction=mn(t.modifiers))},beforeUnmount(e){const t=e.__qtouchpan;t!==void 0&&(t.event!==void 0&&t.end(),qt(t,"main"),qt(t,"temp"),pe.is.firefox===!0&&Ft(e,!1),t.styleCleanup!==void 0&&t.styleCleanup(),delete e.__qtouchpan)}});const kn="q-slider__marker-labels",Yl=e=>({value:e}),Ql=({marker:e})=>m("div",{key:e.value,style:e.style,class:e.classes},e.label),oo=[34,37,40,33,39,38],Zl={...Kt,...no,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:e=>e>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,hideSelection:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},Jl=["pan","update:modelValue","change"];function ea({updateValue:e,updatePosition:t,getDragging:o,formAttrs:l}){const{props:n,emit:r,slots:i,proxy:{$q:s}}=Ce(),c=Yt(n,s),h=Il(l),d=M(!1),x=M(!1),y=M(!1),v=M(!1),_=u(()=>n.vertical===!0?"--v":"--h"),U=u(()=>"-"+(n.switchLabelSide===!0?"switched":"standard")),I=u(()=>n.vertical===!0?n.reverse===!0:n.reverse!==(s.lang.rtl===!0)),P=u(()=>isNaN(n.innerMin)===!0||n.innerMin<n.min?n.min:n.innerMin),V=u(()=>isNaN(n.innerMax)===!0||n.innerMax>n.max?n.max:n.innerMax),B=u(()=>n.disable!==!0&&n.readonly!==!0&&P.value<V.value),F=u(()=>(String(n.step).trim().split(".")[1]||"").length),R=u(()=>n.step===0?1:n.step),$=u(()=>B.value===!0?n.tabindex||0:-1),D=u(()=>n.max-n.min),J=u(()=>V.value-P.value),le=u(()=>ie(P.value)),Z=u(()=>ie(V.value)),H=u(()=>n.vertical===!0?I.value===!0?"bottom":"top":I.value===!0?"right":"left"),ne=u(()=>n.vertical===!0?"height":"width"),oe=u(()=>n.vertical===!0?"width":"height"),ee=u(()=>n.vertical===!0?"vertical":"horizontal"),G=u(()=>{const f={role:"slider","aria-valuemin":P.value,"aria-valuemax":V.value,"aria-orientation":ee.value,"data-step":n.step};return n.disable===!0?f["aria-disabled"]="true":n.readonly===!0&&(f["aria-readonly"]="true"),f}),de=u(()=>`q-slider q-slider${_.value} q-slider--${d.value===!0?"":"in"}active inline no-wrap `+(n.vertical===!0?"row":"column")+(n.disable===!0?" disabled":" q-slider--enabled"+(B.value===!0?" q-slider--editable":""))+(y.value==="both"?" q-slider--focus":"")+(n.label||n.labelAlways===!0?" q-slider--label":"")+(n.labelAlways===!0?" q-slider--label-always":"")+(c.value===!0?" q-slider--dark":"")+(n.dense===!0?" q-slider--dense q-slider--dense"+_.value:""));function C(f){const O="q-slider__"+f;return`${O} ${O}${_.value} ${O}${_.value}${U.value}`}function z(f){const O="q-slider__"+f;return`${O} ${O}${_.value}`}const ve=u(()=>{const f=n.selectionColor||n.color;return"q-slider__selection absolute"+(f!==void 0?` text-${f}`:"")}),g=u(()=>z("markers")+" absolute overflow-hidden"),p=u(()=>z("track-container")),E=u(()=>C("pin")),k=u(()=>C("label")),N=u(()=>C("text-container")),te=u(()=>C("marker-labels-container")+(n.markerLabelsClass!==void 0?` ${n.markerLabelsClass}`:"")),L=u(()=>"q-slider__track relative-position no-outline"+(n.trackColor!==void 0?` bg-${n.trackColor}`:"")),A=u(()=>{const f={[oe.value]:n.trackSize};return n.trackImg!==void 0&&(f.backgroundImage=`url(${n.trackImg}) !important`),f}),K=u(()=>"q-slider__inner absolute"+(n.innerTrackColor!==void 0?` bg-${n.innerTrackColor}`:"")),b=u(()=>{const f={[H.value]:`${100*le.value}%`,[ne.value]:`${100*(Z.value-le.value)}%`};return n.innerTrackImg!==void 0&&(f.backgroundImage=`url(${n.innerTrackImg}) !important`),f});function T(f){const{min:O,max:W,step:Y}=n;let se=O+f*(W-O);if(Y>0){const Se=(se-O)%Y;se+=(Math.abs(Se)>=Y/2?(Se<0?-1:1)*Y:0)-Se}return F.value>0&&(se=parseFloat(se.toFixed(F.value))),ze(se,P.value,V.value)}function ie(f){return D.value===0?0:(f-n.min)/D.value}function be(f,O){const W=ft(f),Y=n.vertical===!0?ze((W.top-O.top)/O.height,0,1):ze((W.left-O.left)/O.width,0,1);return ze(I.value===!0?1-Y:Y,le.value,Z.value)}const ue=u(()=>Ro(n.markers)===!0?n.markers:R.value),Ve=u(()=>{const f=[],O=ue.value,W=n.max;let Y=n.min;do f.push(Y),Y+=O;while(Y<W);return f.push(W),f}),Re=u(()=>{const f=` ${kn}${_.value}-`;return kn+`${f}${n.switchMarkerLabelsSide===!0?"switched":"standard"}${f}${I.value===!0?"rtl":"ltr"}`}),Te=u(()=>n.markerLabels===!1?null:ge(n.markerLabels).map((f,O)=>({index:O,value:f.value,label:f.label||f.value,classes:Re.value+(f.classes!==void 0?" "+f.classes:""),style:{...re(f.value),...f.style||{}}}))),Pe=u(()=>({markerList:Te.value,markerMap:Fe.value,classes:Re.value,getStyle:re})),Le=u(()=>{if(J.value!==0){const f=100*ue.value/J.value;return{...b.value,backgroundSize:n.vertical===!0?`2px ${f}%`:`${f}% 2px`}}return null});function ge(f){if(f===!1)return null;if(f===!0)return Ve.value.map(Yl);if(typeof f=="function")return Ve.value.map(W=>{const Y=f(W);return Mt(Y)===!0?{...Y,value:W}:{value:W,label:Y}});const O=({value:W})=>W>=n.min&&W<=n.max;return Array.isArray(f)===!0?f.map(W=>Mt(W)===!0?W:{value:W}).filter(O):Object.keys(f).map(W=>{const Y=f[W],se=Number(W);return Mt(Y)===!0?{...Y,value:se}:{value:se,label:Y}}).filter(O)}function re(f){return{[H.value]:`${100*(f-n.min)/D.value}%`}}const Fe=u(()=>{if(n.markerLabels===!1)return null;const f={};return Te.value.forEach(O=>{f[O.value]=O}),f});function Ue(){if(i["marker-label-group"]!==void 0)return i["marker-label-group"](Pe.value);const f=i["marker-label"]||Ql;return Te.value.map(O=>f({marker:O,...Pe.value}))}const _t=u(()=>[[Kl,vt,void 0,{[ee.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function vt(f){f.isFinal===!0?(v.value!==void 0&&(t(f.evt),f.touch===!0&&e(!0),v.value=void 0,r("pan","end")),d.value=!1,y.value=!1):f.isFirst===!0?(v.value=o(f.evt),t(f.evt),e(),d.value=!0,r("pan","start")):(t(f.evt),e())}function Ne(){y.value=!1}function Rt(f){t(f,o(f)),e(),x.value=!0,d.value=!0,document.addEventListener("mouseup",He,!0)}function He(){x.value=!1,d.value=!1,e(!0),Ne(),document.removeEventListener("mouseup",He,!0)}function Ae(f){t(f,o(f)),e(!0)}function qe(f){oo.includes(f.keyCode)&&e(!0)}function Xe(f){if(n.vertical===!0)return null;const O=s.lang.rtl!==n.reverse?1-f:f;return{transform:`translateX(calc(${2*O-1} * ${n.thumbSize} / 2 + ${50-100*O}%))`}}function At(f){const O=u(()=>x.value===!1&&(y.value===f.focusValue||y.value==="both")?" q-slider--focus":""),W=u(()=>`q-slider__thumb q-slider__thumb${_.value} q-slider__thumb${_.value}-${I.value===!0?"rtl":"ltr"} absolute non-selectable`+O.value+(f.thumbColor.value!==void 0?` text-${f.thumbColor.value}`:"")),Y=u(()=>({width:n.thumbSize,height:n.thumbSize,[H.value]:`${100*f.ratio.value}%`,zIndex:y.value===f.focusValue?2:void 0})),se=u(()=>f.labelColor.value!==void 0?` text-${f.labelColor.value}`:""),Se=u(()=>Xe(f.ratio.value)),je=u(()=>"q-slider__text"+(f.labelTextColor.value!==void 0?` text-${f.labelTextColor.value}`:""));return()=>{const lt=[m("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[m("path",{d:n.thumbPath})]),m("div",{class:"q-slider__focus-ring fit"})];return(n.label===!0||n.labelAlways===!0)&&(lt.push(m("div",{class:E.value+" absolute fit no-pointer-events"+se.value},[m("div",{class:k.value,style:{minWidth:n.thumbSize}},[m("div",{class:N.value,style:Se.value},[m("span",{class:je.value},f.label.value)])])])),n.name!==void 0&&n.disable!==!0&&h(lt,"push")),m("div",{class:W.value,style:Y.value,...f.getNodeData()},lt)}}function ot(f,O,W,Y){const se=[];n.innerTrackColor!=="transparent"&&se.push(m("div",{key:"inner",class:K.value,style:b.value})),n.selectionColor!=="transparent"&&se.push(m("div",{key:"selection",class:ve.value,style:f.value})),n.markers!==!1&&se.push(m("div",{key:"marker",class:g.value,style:Le.value})),Y(se);const Se=[zo("div",{key:"trackC",class:p.value,tabindex:O.value,...W.value},[m("div",{class:L.value,style:A.value},se)],"slide",B.value,()=>_t.value)];if(n.markerLabels!==!1){const je=n.switchMarkerLabelsSide===!0?"unshift":"push";Se[je](m("div",{key:"markerL",class:te.value},Ue()))}return Se}return Be(()=>{document.removeEventListener("mouseup",He,!0)}),{state:{active:d,focus:y,preventFocus:x,dragging:v,editable:B,classes:de,tabindex:$,attributes:G,step:R,decimals:F,trackLen:D,innerMin:P,innerMinRatio:le,innerMax:V,innerMaxRatio:Z,positionProp:H,sizeProp:ne,isReversed:I},methods:{onActivate:Rt,onMobileClick:Ae,onBlur:Ne,onKeyup:qe,getContent:ot,getThumbRenderFn:At,convertRatioToModel:T,convertModelToRatio:ie,getDraggingRatio:be}}}const ta=()=>({});var na=nt({name:"QSlider",props:{...Zl,modelValue:{required:!0,default:null,validator:e=>typeof e=="number"||e===null},labelValue:[String,Number]},emits:Jl,setup(e,{emit:t}){const{proxy:{$q:o}}=Ce(),{state:l,methods:n}=ea({updateValue:_,updatePosition:I,getDragging:U,formAttrs:Dl(e)}),r=M(null),i=M(0),s=M(0);function c(){s.value=e.modelValue===null?l.innerMin.value:ze(e.modelValue,l.innerMin.value,l.innerMax.value)}ce(()=>`${e.modelValue}|${l.innerMin.value}|${l.innerMax.value}`,c),c();const h=u(()=>n.convertModelToRatio(s.value)),d=u(()=>l.active.value===!0?i.value:h.value),x=u(()=>{const B={[l.positionProp.value]:`${100*l.innerMinRatio.value}%`,[l.sizeProp.value]:`${100*(d.value-l.innerMinRatio.value)}%`};return e.selectionImg!==void 0&&(B.backgroundImage=`url(${e.selectionImg}) !important`),B}),y=n.getThumbRenderFn({focusValue:!0,getNodeData:ta,ratio:d,label:u(()=>e.labelValue!==void 0?e.labelValue:s.value),thumbColor:u(()=>e.thumbColor||e.color),labelColor:u(()=>e.labelColor),labelTextColor:u(()=>e.labelTextColor)}),v=u(()=>l.editable.value!==!0?{}:o.platform.is.mobile===!0?{onClick:n.onMobileClick}:{onMousedown:n.onActivate,onFocus:P,onBlur:n.onBlur,onKeydown:V,onKeyup:n.onKeyup});function _(B){s.value!==e.modelValue&&t("update:modelValue",s.value),B===!0&&t("change",s.value)}function U(){return r.value.getBoundingClientRect()}function I(B,F=l.dragging.value){const R=n.getDraggingRatio(B,F);s.value=n.convertRatioToModel(R),i.value=e.snap!==!0||e.step===0?R:n.convertModelToRatio(s.value)}function P(){l.focus.value=!0}function V(B){if(!oo.includes(B.keyCode))return;ye(B);const F=([34,33].includes(B.keyCode)?10:1)*l.step.value,R=([34,37,40].includes(B.keyCode)?-1:1)*(l.isReversed.value===!0?-1:1)*(e.vertical===!0?-1:1)*F;s.value=ze(parseFloat((s.value+R).toFixed(l.decimals.value)),l.innerMin.value,l.innerMax.value),_()}return()=>{const B=n.getContent(x,l.tabindex,v,F=>{F.push(y())});return m("div",{ref:r,class:l.classes.value+(e.modelValue===null?" q-slider--no-value":""),...l.attributes.value,"aria-valuenow":e.modelValue},B)}}}),oa=`#version 300 es
precision mediump float;
precision mediump int;
precision mediump sampler2D;
precision mediump usampler2D;

uniform usampler2D agentTex; // agent positions
uniform sampler2D renderTex;

uniform float width;
uniform float height;
uniform float maxSpeed;
uniform float turnSpeed;

uniform float sensorWidth;
uniform float sensorHeight;
uniform float maxPossibleReading;

uniform float sensorOffsetDistance;
uniform float sensorAngle;
uniform float randomWeight;

uniform float acceleration;

in vec2 v_texCoord;

const float PI = 3.141;

out uvec4 result;

uint hash(uint x);
uint hash(uint x)
{
    x ^= 2747636419u;
    x *= 2654435769u;
    x ^= x >> 16;
    x *= 2654435769u;
    x ^= x >> 16;
    x *= 2654435769u;
    return x;
}

float sense(float x, float y, float r, float offset);
float sense(float x, float y, float r, float offset)
{
    float sensorAngle = r + offset;
    vec2 sensorDirection = vec2(cos(sensorAngle), sin(sensorAngle));
    vec2 sensorCentre = vec2(x, y) + sensorDirection * sensorOffsetDistance;

    float sum = 0.0;
    for (float i = -sensorWidth; i <= sensorWidth; i += 1.0/width)
    {
        for (float j = -sensorHeight; j <= sensorHeight; j += 1.0/height)
        {
            vec4 reading = texture(renderTex, sensorCentre + vec2(i, j));
            sum += reading.r + reading.g + reading.b;
        }
    }
    return sum / maxPossibleReading;
}

void main(void)
{
    uint pixelIndex = uint((gl_FragCoord.y * width) + (gl_FragCoord.x));
    uint pseudoRandomNumber = hash(pixelIndex);
    float pseudoRandomWeight = float(pseudoRandomNumber) / 4294967295.0; // normalise
    pseudoRandomWeight *= randomWeight;

    uvec4 agent = texture(agentTex, v_texCoord);
    float x = uintBitsToFloat(agent.x);
    float y = uintBitsToFloat(agent.y);
    float r = uintBitsToFloat(agent.z);
    float v = uintBitsToFloat(agent.w);

    // move agent along current path
    x += cos(r) * v * (1.0/width);
    y += sin(r) * v * (1.0/height);

    // check boundaries and reflect angle if hit
    if ( x < 0.0 || x > 1.0 || y < 0.0 || y > 1.0 )
    {
        // pass to other side
        if (x < 0.0) x = 0.99; if (x > 1.0) x = 0.01;
        if (y < 0.0) y = 0.99; if (y > 1.0) y = 0.01;

        // turn them a little
        r += pseudoRandomWeight * PI;
    }


    float forwardReading = sense(x, y, r, 0.0);
    float leftReading = sense(x, y, r, sensorAngle);
    float rightReading = sense(x, y, r, -1.0 * sensorAngle);

    if (forwardReading > leftReading && forwardReading > rightReading)
    {
        r += 0.0; // no change
    }
    else if (forwardReading < leftReading && forwardReading < rightReading)
    {
        r += (pseudoRandomWeight-0.5) * turnSpeed; // turn randomly
    }
    else if (rightReading > forwardReading && forwardReading > leftReading)
    {
        r -= turnSpeed +  ((pseudoRandomWeight-0.5) * turnSpeed); // turn left
    }
    else if (leftReading > forwardReading && forwardReading > rightReading)
    {
        r += turnSpeed + ((pseudoRandomWeight-0.5) * turnSpeed); // turn right
    }

    v = max(max(forwardReading, max(leftReading, rightReading)) * acceleration, 0.1);

    //v = max(max(forwardReading, max(leftReading, rightReading)) * acceleration, 0.1);
    //v += ((forwardReading - 0.5) / 50.0) * acceleration;
    v = min(v, maxSpeed);

    uint x_ = floatBitsToUint(x);
    uint y_ = floatBitsToUint(y);
    uint r_ = floatBitsToUint(r);
    uint v_ = floatBitsToUint(v);

    result = uvec4(x_, y_, r_, v_);
}
`,la=`#version 300 es

precision mediump float;

in vec4 m_position;

out vec2 v_texCoord;

void main(void)
{
  gl_Position = vec4(m_position.xy, 0.0, 1.0);
  v_texCoord = m_position.zw;
}
`,aa=`#version 300 es
precision mediump float;
precision mediump sampler2D;

uniform float fadeSpeed;
uniform float width;
uniform float height;

in vec2 v_texCoord;
uniform sampler2D renderTex;

out vec4 color;

void main(void)
{
  vec4 sum = vec4(0.0, 0.0, 0.0, 0.0);

  // 3x3 blur
  for (float offsetX = -1.0/width; offsetX <= 1.0/width; offsetX += 1.0/width)
  {
    for (float offsetY = -1.0/height; offsetY <= 1.0/height; offsetY += 1.0/height)
    {
      sum += texture(renderTex, v_texCoord + vec2(offsetX, offsetY));
    }
  }
  vec4 blurredCol = sum / 9.0;

  color = blurredCol;

  // Fade each trailing agent pixel out over time
  color = color - fadeSpeed;
}
`,ra=`#version 300 es

precision mediump float;

in vec4 m_position;

out vec2 v_texCoord;

void main(void)
{
  gl_Position = vec4(m_position.xy, 0.0, 1.0);
  v_texCoord = m_position.pq;
}
`,ia=`#version 300 es

precision mediump float;
precision mediump int;
precision mediump sampler2D;

in vec4 col;

out vec4 color;

void main(void)
{
  color = col;
}
`,ua=`#version 300 es
precision mediump float;

in vec2 r_position;
in vec2 r_agentCoord;

precision mediump sampler2D;
precision mediump usampler2D;

uniform usampler2D agentTex;
uniform sampler2D agentCol;
uniform float pointSize;

out vec4 col;

void main(void)
{
  // get the r & g (x & y positions) value of pixels in agentTex
  uvec4 agent = texture(agentTex, r_agentCoord);
  float v = uintBitsToFloat(agent.w);

  col = texture(agentCol, r_agentCoord);
  col.r = col.r * v;
  col.g = col.g * (1.0 - v) - 0.1;
  col.b = 1.0;

  float x = uintBitsToFloat(agent.x);
  float y = uintBitsToFloat(agent.y);
  gl_Position = vec4(2.0 * x - 1.0, 2.0 * y - 1.0, 0.0, 1.0);

  gl_PointSize = pointSize;
}
`;const sa=2,ca=60;var Jt;const me={agents:null,agentColors:null,canvas:null,preset:null};var j=null,Me=null,Je=null,Et=null,we=null;function da(e,t){document.getElementById("fps"),me.canvas=e,me.preset=t;let o=me.preset.createAgents();me.agents=o.agents,me.agentColors=o.colors,me.sensorRadius=sa;var l={depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!0,premultipliedAlpha:!1},n=e.getContext("webgl2",l);n||(n=e.getContext("webgl",l)||e.getContext("experimental-webgl",l)),j=n,n.viewport(0,0,e.width,e.height),n.clearColor(0,0,0,0),n.clear(n.COLOR_BUFFER_BIT),n.enable(n.BLEND),n.blendFunc(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA);var r=n.getExtension("EXT_color_buffer_float");if(!r){alert("EXT_color_buffer_float failed to load");return}Jt=!0,Me=fa(n),va(n,me,Me),ma(n,me,Me)}function fa(e){const t=Nt(e,la,oa),o=Nt(e,ua,ia),l=Nt(e,ra,aa);return{moveAgent:t,renderAgent:o,postProcessing:l}}function Nt(e,t,o){const l=e.createShader(e.VERTEX_SHADER);e.shaderSource(l,t),e.compileShader(l),e.getShaderParameter(l,e.COMPILE_STATUS)||console.error(e.getShaderInfoLog(l));const n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(n,o),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||console.error(e.getShaderInfoLog(n));const r=e.createProgram();e.attachShader(r,l),e.attachShader(r,n),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)||console.error(e.getProgramInfoLog(r));var i=e.getProgramParameter(r,e.ACTIVE_UNIFORMS),s={};for(let h=0;h<i;h++){var c=e.getActiveUniform(r,h).name;s[c]=e.getUniformLocation(r,c)}return e.deleteShader(l),e.deleteShader(n),{program:r,uniforms:s,use:function(){e.useProgram(this.program)}}}function va(e,t,o){o.moveAgent.use();let l=o.moveAgent.uniforms;e.uniform1i(l.agentTex,0),e.uniform1i(l.renderTex,1),e.uniform1f(l.width,t.canvas.width),e.uniform1f(l.height,t.canvas.height),o.renderAgent.use();let n=o.renderAgent.uniforms;e.uniform1i(n.agentTex,0),e.uniform1i(n.agentCol,1),e.uniform1f(n.pointSize,t.preset.pointSize),o.postProcessing.use();let r=o.postProcessing.uniforms;e.uniform1i(r.renderTex,0),e.uniform1f(r.fadeSpeed,t.preset.fadeSpeed/255),e.uniform1f(r.width,t.canvas.width),e.uniform1f(r.height,t.canvas.width),e.useProgram(null)}function ma(e,t,o){let l=[],n=t.canvas.height/t.canvas.width;for(let v=0;v<t.agents.length;v++)l.push(t.agents[v].x*n+.5),l.push(t.agents[v].y+.5),l.push(t.agents[v].rot),l.push(.5);we=ha(e,new Float32Array(l),new Uint8Array(t.agentColors)),e.useProgram(o.moveAgentProg),e.useProgram(null);var r=e.getAttribLocation(o.moveAgent.program,"m_position"),i=e.getAttribLocation(o.renderAgent.program,"r_agentCoord"),s=e.getAttribLocation(o.postProcessing.program,"m_position");Je={positionBuffer:e.createBuffer(),lookupBuffer:e.createBuffer(),inputBuffer:e.createBuffer()},e.bindBuffer(e.ARRAY_BUFFER,Je.positionBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,0,0,1,-1,1,0,-1,1,0,1,-1,1,0,1,1,-1,1,0,1,1,1,1]),e.STATIC_DRAW),e.enableVertexAttribArray(r),e.vertexAttribPointer(r,4,e.FLOAT,!1,0,0),e.vertexAttribPointer(s,4,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,Je.lookupBuffer);let c=[];for(let v=0;v<we.agentTextureLength;v++)for(let _=0;_<we.agentTextureLength;_++)c.push((_+.5)/we.agentTextureLength),c.push((v+.5)/we.agentTextureLength);e.bufferData(e.ARRAY_BUFFER,new Float32Array(c),e.STATIC_DRAW),e.enableVertexAttribArray(i),e.bindBuffer(e.ARRAY_BUFFER,Je.lookupBuffer),e.vertexAttribPointer(i,2,e.FLOAT,!1,0,0),Et={agentFramebuffer:e.createFramebuffer(),postProcessingFrameBuffer:e.createFramebuffer()};var h=!0,d=window.performance.now(),x=1e3/ca;function y(v){if(!Jt)return;let _=v-d;_>x&&(d=v-_%x,ga(e,t,Me),pa(h,e,Me,Et,we),h=!h),window.requestAnimationFrame(y)}window.requestAnimationFrame(y)}function st(e,t,o,l,n,r,i){const s=e.createTexture();return e.bindTexture(e.TEXTURE_2D,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_BASE_LEVEL,0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAX_LEVEL,0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texImage2D(e.TEXTURE_2D,0,t,o,l,0,n,r,i),e.bindTexture(e.TEXTURE_2D,null),s}function ha(e,t,o){const l=Math.ceil(Math.sqrt(me.agents.length));let n=new Uint32Array(t.buffer);const r=st(e,e.RGBA32UI,l,l,e.RGBA_INTEGER,e.UNSIGNED_INT,n),i=st(e,e.RGBA32UI,l,l,e.RGBA_INTEGER,e.UNSIGNED_INT,null),s=st(e,e.RGBA,l,l,e.RGBA,e.UNSIGNED_BYTE,o),c=st(e,e.RGBA,me.canvas.width,me.canvas.height,e.RGBA,e.UNSIGNED_BYTE,null),h=st(e,e.RGBA,me.canvas.width,me.canvas.height,e.RGBA,e.UNSIGNED_BYTE,null);return{agentTexture:r,agentTextureSwap:i,agentColor:s,agentTextureLength:l,renderTexture:c,renderTextureSwap:h}}function ga(e,t,o){o.moveAgent.use();let l=o.moveAgent.uniforms;e.uniform1f(l.maxSpeed,t.preset.maxSpeed.value),e.uniform1f(l.turnSpeed,t.preset.turnSpeed.value),e.uniform1f(l.sensorWidth,t.sensorRadius/t.canvas.width),e.uniform1f(l.sensorHeight,t.sensorRadius/t.canvas.height);var n=2*t.sensorRadius+1,r=n*n*3;e.uniform1f(l.maxPossibleReading,r),e.uniform1f(l.sensorOffsetDistance,t.preset.sensorOffsetDistance.value/t.canvas.width),e.uniform1f(l.sensorAngle,t.preset.sensorAngle.value),e.uniform1f(l.randomWeight,.1),e.uniform1f(l.acceleration,t.preset.acceleration.value)}function pa(e,t,o,l,n){t.viewport(0,0,n.agentTextureLength,n.agentTextureLength),o.moveAgent.use(),t.bindFramebuffer(t.FRAMEBUFFER,l.agentFramebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e?n.agentTextureSwap:n.agentTexture,0),t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,e?n.agentTexture:n.agentTextureSwap),t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_2D,n.renderTexture),t.drawArrays(t.TRIANGLES,0,6),t.viewport(0,0,me.canvas.width,me.canvas.height),o.renderAgent.use(),t.bindFramebuffer(t.FRAMEBUFFER,l.postProcessingFrameBuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e?n.renderTextureSwap:n.renderTexture,0),t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,n.agentTexture),t.activeTexture(t.TEXTURE0+1),t.bindTexture(t.TEXTURE_2D,n.agentColor),t.drawArrays(t.POINTS,0,me.agents.length),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e?n.renderTexture:n.renderTextureSwap,0),o.postProcessing.use(),t.activeTexture(t.TEXTURE0+0),t.bindTexture(t.TEXTURE_2D,e?n.renderTextureSwap:n.renderTexture),t.drawArrays(t.TRIANGLES,0,6),t.bindFramebuffer(t.FRAMEBUFFER,null),t.drawArrays(t.TRIANGLES,0,6)}function ba(){Jt=!1;for(var e=j.getParameter(j.MAX_TEXTURE_IMAGE_UNITS),t=0;t<e;++t)j.activeTexture(j.TEXTURE0+t),j.bindTexture(j.TEXTURE_2D,null),j.bindTexture(j.TEXTURE_CUBE_MAP,null);j.bindBuffer(j.ARRAY_BUFFER,null),j.bindBuffer(j.ELEMENT_ARRAY_BUFFER,null),j.bindRenderbuffer(j.RENDERBUFFER,null),j.bindFramebuffer(j.FRAMEBUFFER,null),j.deleteProgram(Me.moveAgentProg),j.deleteProgram(Me.renderAgentProg),j.deleteProgram(Me.postProcessingProg),j.deleteFramebuffer(Et.agentFramebuffer),j.deleteFramebuffer(Et.postProcessingFrameBuffer),j.deleteBuffer(Je.lookupBuffer),j.deleteBuffer(Je.positionBuffer),j.deleteTexture(we.agentTex),j.deleteTexture(we.agentTex_),j.deleteTexture(we.agentColor),j.deleteTexture(we.renderTex),j.deleteTexture(we.renderTex_),gl.getExtension("WEBGL_lose_context").loseContext()}const Sa=.5*(Math.sqrt(3)-1),ct=(3-Math.sqrt(3))/6,Bn=e=>Math.floor(e)|0,Fn=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function ya(e=Math.random){const t=xa(e),o=new Float64Array(t).map(n=>Fn[n%12*2]),l=new Float64Array(t).map(n=>Fn[n%12*2+1]);return function(r,i){let s=0,c=0,h=0;const d=(r+i)*Sa,x=Bn(r+d),y=Bn(i+d),v=(x+y)*ct,_=x-v,U=y-v,I=r-_,P=i-U;let V,B;I>P?(V=1,B=0):(V=0,B=1);const F=I-V+ct,R=P-B+ct,$=I-1+2*ct,D=P-1+2*ct,J=x&255,le=y&255;let Z=.5-I*I-P*P;if(Z>=0){const oe=J+t[le],ee=o[oe],G=l[oe];Z*=Z,s=Z*Z*(ee*I+G*P)}let H=.5-F*F-R*R;if(H>=0){const oe=J+V+t[le+B],ee=o[oe],G=l[oe];H*=H,c=H*H*(ee*F+G*R)}let ne=.5-$*$-D*D;if(ne>=0){const oe=J+1+t[le+1],ee=o[oe],G=l[oe];ne*=ne,h=ne*ne*(ee*$+G*D)}return 70*(s+c+h)}}function xa(e){const o=new Uint8Array(512);for(let l=0;l<512/2;l++)o[l]=l;for(let l=0;l<512/2-1;l++){const n=l+~~(e()*(256-l)),r=o[l];o[l]=o[n],o[n]=r}for(let l=256;l<512;l++)o[l]=o[l-256];return o}const wa=ko({name:"SlimeSim",components:{},watch:{presetSelection(e){try{ba()}catch{}var t=this.$refs.visCanvas;t.width=Math.round(window.innerWidth),t.height=Math.round(window.innerHeight)-50;let o={...e,...this.params};da(t,o)}},mounted(){this.presetSelection=this.presets[0]},data(){return{presetSelection:null,presets:[{label:"Circle Moving Towards Centre",createAgents:function(){let t=[],o=[],l=.4;for(let n=0;n<65536;n++){let r=2*Math.PI*Math.random(),i=l*Math.sqrt(Math.random()),s=i*Math.cos(r),c=i*Math.sin(r),h=Math.atan2(-c,-s);t.push({x:s,y:c,rot:h.toFixed(2)}),o.push(255),o.push(255),o.push(255),o.push(255)}return{agents:t,colors:o}},pointSize:1,fadeSpeed:10},{label:"Perlin Noise",createAgents:function(){let t=[],o=[];var l=-.95;const n=ya();for(let c=0;c<65536;c++){var r=2*(Math.random()-.5),i=2*(Math.random()-.5),s=n(r,i);s>l&&(t.push({x:r,y:i,rot:(Math.random()*(0-2*Math.PI)+2*Math.PI).toFixed(2)}),o.push(255),o.push(255),o.push(255),o.push(255))}return{agents:t,colors:o}},pointSize:1,fadeSpeed:10}],params:{turnSpeed:{value:.2,min:.1,max:1,label:"Turn Speed"},maxSpeed:{value:2,min:0,max:5,label:"Max Speed"},sensorOffsetDistance:{value:40,min:10,max:100,label:"Sensor Range"},sensorAngle:{value:.25,min:.1,max:.6,label:"Sensor Angle"},acceleration:{value:2,min:1,max:10,label:"Acceleration"}}}}}),Ca={class:"bg-black",id:"vis",ref:"visCanvas"};function Ta(e,t,o,l,n,r){return Vt(),Pt(sn,null,[Bo("canvas",Ca,null,512),gt(Yo,{class:"overlay",square:"",flat:"",bordered:"",style:{width:"250px"}},{default:un(()=>[gt(Qo,null,{default:un(()=>[gt(Wl,{modelValue:e.presetSelection,"onUpdate:modelValue":t[0]||(t[0]=i=>e.presetSelection=i),options:e.presets,label:"Initial Condition",class:"full-width"},null,8,["modelValue","options"]),(Vt(!0),Pt(sn,null,Fo(Object.keys(e.params),i=>(Vt(),Pt("div",{key:i,style:{width:"100%"}},[qo(cn(e.params[i].label)+": "+cn(e.params[i].value)+" ",1),gt(na,{modelValue:e.params[i].value,"onUpdate:modelValue":s=>e.params[i].value=s,min:e.params[i].min,max:e.params[i].max,step:.1,"track-size":"10px","thumb-size":"20px",color:"accent"},null,8,["modelValue","onUpdate:modelValue","min","max","step"])]))),128))]),_:1})]),_:1})],64)}var Va=Ao(wa,[["render",Ta]]);export{Va as default};
